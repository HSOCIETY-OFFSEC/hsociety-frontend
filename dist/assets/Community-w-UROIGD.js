import{u as s,j as e}from"./index-BKTFHamk.js";import{r as a}from"./react-vendor-Dt--M4EP.js";import{N as t,J as r,i,w as n,d as o,j as l,C as c,K as d,b as h,L as m,M as p,O as u,P as j,Q as x,R as v,S as g,l as b}from"./Card-D7Goz3Sa.js";import{u as y}from"./useScrollReveal-BC-245pq.js";import{B as f}from"./Button-Byl8E1dD.js";import{a as N,A as w,b as S}from"./api.client-DUIoE9I7.js";import"./icons-9q4Ww-N4.js";const k=(s={},e="student")=>({stats:s.stats||{learners:12e3,questions:4e3,answered:1300},channels:s.channels||[{id:"intro",name:"Introductions"},{id:"beginner",name:"Beginner Q&A"},{id:"ctf",name:"CTF Talk"},{id:"blue-team",name:"Blue Team"},{id:"red-team",name:"Red Team"}],tags:s.tags||["#career-switch","#ctf","#web-security","#blue-team","#owasp","#interview-prep"],posts:s.posts||[],mentor:s.mentor||{id:"ria",name:"Ria N.",role:"Blue Team Lead",avatar:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=200&q=80"},challenge:s.challenge||{id:"weekly",title:"corporate"===e?"Top Learner Highlights":"Challenge of the Week",description:"corporate"===e?"See the most active learners and award mentorship credits.":"Break down a real-world phishing sample and map it to MITRE."}}),z=s=>((s=[])=>s.map((s,e)=>({id:s.id||`post-${e+1}`,author:s.author||"Community Member",role:s.role||"Security Learner",time:s.time||"just now",title:s.title||"Untitled post",body:s.body||s.content||"",likes:Number(s.likes||0),replies:Number(s.replies||0),tags:s.tags||[],avatar:s.avatar||"https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=200&q=80",isSaved:Boolean(s.isSaved)})))(s),C=()=>{var C,T,M,I,O,L;y();const{user:E}=s(),[F,q]=a.useState("popular"),[P,B]=a.useState({stats:{learners:0,questions:0,answered:0},channels:[],tags:[],posts:[],mentor:null,challenge:null}),[R,A]=a.useState(!0),[H,Y]=a.useState(!1),[U,W]=a.useState(""),[V,$]=a.useState(""),Q=(null==E?void 0:E.role)||"student",G="corporate"===Q,J=a.useMemo(()=>({title:G?"Host an Office Hour":"Start a Study Group",subtitle:G?"Support junior talent with live Q&A and review sessions.":"Find peers for weekly practice and accountability."}),[G]);a.useEffect(()=>{let s=!0;return(async()=>{A(!0),$("");const e=await(async({role:s="student",feed:e="popular"}={})=>{const a=await N.get(`${w.COMMUNITY.OVERVIEW}?role=${s}&feed=${e}`);return a.success?{success:!0,data:k(a.data,s)}:{success:!1,error:a.error||"Failed to load community overview"}})({role:Q,feed:F});s&&(e.success?B({...e.data,posts:z(e.data.posts||[])}):$(e.error||"Failed to load community data."),A(!1))})(),()=>{s=!1}},[Q,F]);const _=async s=>{B(e=>({...e,posts:e.posts.map(e=>e.id===s?{...e,likes:e.likes+1}:e)})),await(async({postId:s,reaction:e="like"})=>{const a=S(w.COMMUNITY.POST_REACT,{id:s}),t=await N.post(a,{reaction:e});return{success:t.success,error:t.error}})({postId:s,reaction:"like"})},K=async(s,e)=>{B(a=>({...a,posts:a.posts.map(a=>a.id===s?{...a,isSaved:!e}:a)})),await(async({postId:s,saved:e=!0})=>{const a=S(w.COMMUNITY.POST_SAVE,{id:s}),t=await N.post(a,{saved:e});return{success:t.success,error:t.error}})({postId:s,saved:!e})};return e.jsxs(e.Fragment,{children:[e.jsx(t,{}),e.jsxs("div",{className:"community-page",children:[e.jsxs("header",{className:"community-hero reveal-on-scroll",children:[e.jsxs("div",{className:"community-hero-content",children:[e.jsxs("div",{children:[e.jsx("p",{className:"community-kicker",children:"HSOCIETY Community"}),e.jsx("h1",{children:"Where future defenders meet."}),e.jsx("p",{children:"Ask questions, share wins, and build your cybersecurity path with peers and mentors."})]}),e.jsxs(f,{variant:"primary",size:"large",children:[G?e.jsx(r,{size:18}):e.jsx(i,{size:18}),J.title]})]}),e.jsxs("div",{className:"community-hero-stats",children:[e.jsxs("div",{className:"hero-stat",children:[e.jsx(n,{size:18}),e.jsxs("span",{children:[P.stats.learners||0," learners"]})]}),e.jsxs("div",{className:"hero-stat",children:[e.jsx(o,{size:18}),e.jsxs("span",{children:[P.stats.questions||0," questions"]})]}),e.jsxs("div",{className:"hero-stat",children:[e.jsx(l,{size:18}),e.jsxs("span",{children:[P.stats.answered||0," answered"]})]})]})]}),e.jsxs("div",{className:"community-layout",children:[e.jsxs("aside",{className:"community-sidebar reveal-on-scroll",children:[e.jsxs(c,{padding:"large",className:"sidebar-card",children:[e.jsx("h3",{children:"Channels"}),e.jsx("div",{className:"sidebar-list",children:P.channels.map(s=>e.jsxs("button",{type:"button",children:[e.jsx(d,{size:16})," ",s.name]},s.id))})]}),e.jsxs(c,{padding:"large",className:"sidebar-card",children:[e.jsx("h3",{children:G?"Corporate Corner":"Student Starter Pack"}),e.jsx("p",{children:G?"Share internship openings, sponsor labs, and offer mentorship.":"Guided paths, beginner labs, and weekly milestones."}),e.jsx("div",{className:"sidebar-list",children:G?e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",children:[e.jsx(r,{size:16})," Post Internships"]}),e.jsxs("button",{type:"button",children:[e.jsx(h,{size:16})," Sponsor Lab Time"]}),e.jsxs("button",{type:"button",children:[e.jsx(n,{size:16})," Mentor Circle"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",children:[e.jsx(i,{size:16})," Learning Roadmaps"]}),e.jsxs("button",{type:"button",children:[e.jsx(h,{size:16})," Beginner Labs"]}),e.jsxs("button",{type:"button",children:[e.jsx(n,{size:16})," Find Study Buddy"]})]})})]}),e.jsxs(c,{padding:"large",className:"sidebar-card",children:[e.jsx("h3",{children:"Trending Tags"}),e.jsx("div",{className:"tag-list",children:P.tags.map(s=>e.jsx("span",{children:s},s))})]})]}),e.jsxs("main",{className:"community-feed",children:[e.jsxs(c,{padding:"large",className:"post-creator reveal-on-scroll",children:[e.jsxs("div",{className:"post-creator-header",children:[e.jsxs("div",{className:"avatar-frame",children:[e.jsx("img",{src:"https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=200&q=80",alt:"HSOCIETY member",loading:"lazy",onError:s=>{s.currentTarget.style.opacity="0"}}),e.jsx("div",{className:"avatar-fallback","aria-hidden":"true"})]}),e.jsx("input",{type:"text",value:U,onChange:s=>W(s.target.value),placeholder:G?"Share an internship, office hours, or security insight...":"Ask a question or share a win..."})]}),e.jsxs("div",{className:"post-creator-actions",children:[e.jsxs("div",{className:"post-creator-tools",children:[e.jsxs("button",{type:"button",children:[e.jsx(m,{size:16})," Media"]}),e.jsxs("button",{type:"button",children:[e.jsx(h,{size:16})," Lab Logs"]})]}),e.jsxs(f,{variant:"secondary",size:"small",onClick:async()=>{if(!U.trim()||H)return;Y(!0),$("");const s=await(async({content:s,role:e})=>{const a=(({content:s,role:e})=>({content:s.trim(),visibility:"public",roleContext:e||"student",attachments:[],metadata:{source:"web",version:"1"}}))({content:s,role:e}),t=await N.post(w.COMMUNITY.POSTS,a);return t.success?{success:!0,data:t.data}:{success:!1,error:t.error||"Failed to create post"}})({content:U,role:Q});if(!s.success)return $(s.error||"Failed to create post."),void Y(!1);const e=z([s.data])[0];B(s=>({...s,posts:[e,...s.posts]})),W(""),Y(!1)},disabled:H||!U.trim(),children:[e.jsx(p,{size:16}),H?"Posting...":"Post"]})]})]}),e.jsxs("div",{className:"feed-tabs reveal-on-scroll",children:[e.jsxs("button",{type:"button",className:"popular"===F?"active":"",onClick:()=>q("popular"),children:[e.jsx(u,{size:16}),"Popular"]}),e.jsxs("button",{type:"button",className:"new"===F?"active":"",onClick:()=>q("new"),children:[e.jsx(j,{size:16}),"New"]}),e.jsxs("button",{type:"button",className:"saved"===F?"active":"",onClick:()=>q("saved"),children:[e.jsx(x,{size:16}),"Saved"]}),e.jsxs("button",{type:"button",children:[e.jsx(v,{size:16}),"Filters"]})]}),e.jsxs("div",{className:"post-list",children:[V&&e.jsx(c,{padding:"large",className:"post-card",children:e.jsx("p",{children:V})}),R&&e.jsx(c,{padding:"large",className:"post-card",children:e.jsx("p",{children:"Loading community feed..."})}),!R&&P.posts.map(s=>e.jsxs(c,{padding:"large",className:"post-card reveal-on-scroll",children:[e.jsxs("div",{className:"post-header",children:[e.jsxs("div",{className:"avatar-frame",children:[e.jsx("img",{src:s.avatar,alt:s.author,loading:"lazy",onError:s=>{s.currentTarget.style.opacity="0"}}),e.jsx("div",{className:"avatar-fallback","aria-hidden":"true"})]}),e.jsxs("div",{children:[e.jsx("h4",{children:s.author}),e.jsxs("span",{children:[s.role," Â· ",s.time]})]})]}),e.jsx("h3",{children:s.title}),e.jsx("p",{children:s.body}),e.jsx("div",{className:"post-tags",children:s.tags.map(s=>e.jsx("span",{children:s},s))}),e.jsxs("div",{className:"post-actions",children:[e.jsxs("button",{type:"button",onClick:()=>_(s.id),children:[e.jsx(g,{size:16})," ",s.likes]}),e.jsxs("button",{type:"button",children:[e.jsx(o,{size:16})," ",s.replies]}),e.jsxs("button",{type:"button",onClick:()=>K(s.id,s.isSaved),children:[e.jsx(b,{size:16})," ",s.isSaved?"Saved":"Save"]})]})]},s.id))]})]}),e.jsxs("aside",{className:"community-right reveal-on-scroll",children:[e.jsxs(c,{padding:"large",className:"sidebar-card",children:[e.jsx("h3",{children:G?"Sponsor a Session":"Mentor Office Hours"}),e.jsx("p",{children:G?"Offer a workshop, mock interview, or skills review.":"Weekly live sessions with senior analysts."}),e.jsxs("div",{className:"mentor-item",children:[e.jsxs("div",{className:"avatar-frame",children:[e.jsx("img",{src:(null==(C=P.mentor)?void 0:C.avatar)||"https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=200&q=80",alt:(null==(T=P.mentor)?void 0:T.name)||"Mentor",loading:"lazy",onError:s=>{s.currentTarget.style.opacity="0"}}),e.jsx("div",{className:"avatar-fallback","aria-hidden":"true"})]}),e.jsxs("div",{children:[e.jsx("h4",{children:(null==(M=P.mentor)?void 0:M.name)||"Mentor"}),e.jsx("span",{children:(null==(I=P.mentor)?void 0:I.role)||"Security Mentor"})]})]}),e.jsx(f,{variant:"ghost",size:"small",children:G?"Propose Session":"Join Session"})]}),e.jsxs(c,{padding:"large",className:"sidebar-card",children:[e.jsx("h3",{children:(null==(O=P.challenge)?void 0:O.title)||(G?"Top Learner Highlights":"Challenge of the Week")}),e.jsx("p",{children:null==(L=P.challenge)?void 0:L.description}),e.jsx(f,{variant:"secondary",size:"small",children:G?"View Learners":"Start Challenge"})]})]})]})]})]})};export{C as default};
