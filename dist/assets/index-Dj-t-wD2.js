const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-CH3LVZCE.js","assets/react-vendor-Dt--M4EP.js","assets/Card-B9fCiNLr.js","assets/Login-D6nF2Vde.css","assets/Dashboard-BQppQwJW.js","assets/Navbar-DxjRtyBU.js","assets/ThemeToggle-CQ0JBxkd.js","assets/Dashboard-DmmEh5Eg.css","assets/Audits-BvE0ZfYT.js","assets/Audits-hpc_Elhl.css","assets/Pentest-EPnRfn8-.js","assets/input.validator-7PKJK-co.js","assets/Pentest-D6yeA-xu.css","assets/Feedback-V_oer5Qt.js","assets/Feedback-D6Z5KDy6.css","assets/Landing-ar6XmuoC.js","assets/Landing-DSOjiYQ_.css"])))=>i.map(i=>d[i]);
import{r as e,a as t,R as o,B as r,b as n,c as s,N as i}from"./react-vendor-Dt--M4EP.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var a={exports:{}},l={},c=e,u=Symbol.for("react.element"),d=Symbol.for("react.fragment"),h=Object.prototype.hasOwnProperty,m=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,g={key:!0,ref:!0,__self:!0,__source:!0};function p(e,t,o){var r,n={},s=null,i=null;for(r in void 0!==o&&(s=""+o),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(i=t.ref),t)h.call(t,r)&&!g.hasOwnProperty(r)&&(n[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===n[r]&&(n[r]=t[r]);return{$$typeof:u,type:e,key:s,ref:i,props:n,_owner:m.current}}l.Fragment=d,l.jsx=p,l.jsxs=p,a.exports=l;var f=a.exports,y={},x=t;y.createRoot=x.createRoot,y.hydrateRoot=x.hydrateRoot;const S="hsociety_session";const j=new class{constructor(){this.storage="undefined"!=typeof window?window.sessionStorage:null}setSession(e){if(!this.storage)return!1;try{const t={...e,timestamp:e.timestamp||Date.now(),expiresAt:Date.now()+864e5};return this.storage.setItem(S,JSON.stringify(t)),!0}catch(t){return console.error("Failed to set session:",t),!1}}getSession(){if(!this.storage)return null;try{const e=this.storage.getItem(S);return e?JSON.parse(e):null}catch(e){return console.error("Failed to get session:",e),null}}updateSession(e){const t=this.getSession();if(!t)return!1;const o={...t,...e,timestamp:Date.now()};return this.setSession(o)}clearSession(){if(this.storage)try{this.storage.removeItem(S),this.storage.removeItem("logout-reason")}catch(e){console.error("Failed to clear session:",e)}}isSessionValid(){const e=this.getSession();return!!e&&(!(!e.user||!e.token)&&(!(e.expiresAt&&Date.now()>e.expiresAt)||(console.log("Session expired"),this.clearSession(),!1)))}getToken(){const e=this.getSession();return e?e.token:null}getUser(){const e=this.getSession();return e?e.user:null}isAuthenticated(){return this.isSessionValid()}getSessionAge(){const e=this.getSession();return e&&e.timestamp?Date.now()-e.timestamp:null}getTimeUntilExpiry(){const e=this.getSession();if(!e||!e.expiresAt)return null;const t=e.expiresAt-Date.now();return t>0?t:0}},_=e.createContext(void 0),v=({children:t})=>{const[o,r]=e.useState(null),[n,s]=e.useState(null),[i,a]=e.useState(!1),[l,c]=e.useState(!0),[u,d]=e.useState(null);e.useEffect(()=>{h()},[]);const h=async()=>{try{c(!0);const e=j.getSession();if(e&&e.token&&e.user){j.isSessionValid()?(r(e.user),s(e.token),a(!0),m()):await g(!1)}}catch(e){console.error("Auth initialization error:",e),await g(!1)}finally{c(!1)}},m=()=>{u&&u();const e=(({timeout:e=9e5,onTimeout:t,onWarning:o=null,warningTime:r=12e4,events:n=["mousedown","keydown","scroll","touchstart","click","mousemove"]}={})=>{if(!t||"function"!=typeof t)return console.error("Auto logout requires onTimeout callback"),()=>{};let s=null,i=null,a=!1;const l=()=>{a=!1,s&&clearTimeout(s),i&&clearTimeout(i),o&&r>0&&r<e&&(i=setTimeout(()=>{a||(a=!0,o({remainingTime:e-r,totalTimeout:e}))},e-r)),s=setTimeout(()=>{console.log("Auto logout triggered due to inactivity"),t()},e)},c=()=>{l()};return n.forEach(e=>{window.addEventListener(e,c,{passive:!0})}),l(),()=>{n.forEach(e=>{window.removeEventListener(e,c)}),s&&clearTimeout(s),i&&clearTimeout(i),console.log("Auto logout monitor cleaned up")}})({timeout:9e5,onTimeout:async()=>{console.log("Session timed out due to inactivity"),await g(!0)},events:["mousedown","keydown","scroll","touchstart","click"]});d(()=>e)},g=async(e=!1)=>{try{u&&(u(),d(null)),j.clearSession(),r(null),s(null),a(!1),e&&sessionStorage.setItem("logout-reason","inactivity"),"undefined"!=typeof window&&(window.location.href="/login")}catch(t){console.error("Logout error:",t),j.clearSession(),r(null),s(null),a(!1)}},p={user:o,token:n,isAuthenticated:i,isLoading:l,login:async(e,t)=>{try{if(!e||!t)throw new Error("Invalid login credentials");return j.setSession({user:e,token:t,timestamp:Date.now()}),r(e),s(t),a(!0),m(),{success:!0}}catch(o){return console.error("Login error:",o),{success:!1,error:o.message}}},logout:g,updateUser:e=>{if(!i)return;const t={...o,...e};j.updateSession({user:t}),r(t)},refreshToken:async()=>{try{const e=n;return j.updateSession({token:e}),s(e),{success:!0,token:e}}catch(e){return console.error("Token refresh error:",e),await g(),{success:!1,error:e.message}}},hasRole:e=>!(!o||!o.role)&&o.role===e,hasAnyRole:e=>!(!o||!o.role)&&e.includes(o.role)};return f.jsx(_.Provider,{value:p,children:t})},w=()=>{const t=e.useContext(_);if(void 0===t)throw new Error("useAuth must be used within an AuthProvider");return t},E=e.createContext(void 0),k=({children:t})=>{const[o,r]=e.useState(()=>{if("undefined"!=typeof window){return localStorage.getItem("hsociety-theme")||"light"}return"light"});e.useEffect(()=>{const e=document.documentElement;e.removeAttribute("data-theme"),e.setAttribute("data-theme",o),localStorage.setItem("hsociety-theme",o);const t=document.querySelector('meta[name="theme-color"]');t&&t.setAttribute("content","dark"===o?"#000000":"#ffffff"),n(o)},[o]);const n=e=>{const t=document.querySelector('link[rel="icon"]'),o=document.querySelector('link[rel="apple-touch-icon"]'),r="dark"===e?"/FAVICON_HSOCIETY_WHITE/favicon.ico":"/FAVICON_HSOCIETY_BLACK/favicon.ico",n="dark"===e?"/FAVICON_HSOCIETY_WHITE/apple-touch-icon.png":"/FAVICON_HSOCIETY_BLACK/apple-touch-icon.png";t&&(t.href=r),o&&(o.href=n)},s={theme:o,toggleTheme:()=>{r(e=>"light"===e?"dark":"light")},setTheme:e=>{"light"!==e&&"dark"!==e||r(e)},isDark:"dark"===o,isLight:"light"===o};return f.jsx(E.Provider,{value:s,children:t})},A=()=>{const t=e.useContext(E);if(void 0===t)throw new Error("useTheme must be used within a ThemeProvider");return t},T={},L=function(e,t,o){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),o=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in T)return;T[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,o&&n.setAttribute("nonce",o),document.head.appendChild(n),t?new Promise((t,o)=>{n.addEventListener("load",t),n.addEventListener("error",()=>o(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})},I=o.lazy(()=>L(()=>import("./Login-CH3LVZCE.js"),__vite__mapDeps([0,1,2,3]))),O=o.lazy(()=>L(()=>import("./Dashboard-BQppQwJW.js"),__vite__mapDeps([4,1,5,2,6,7]))),b=o.lazy(()=>L(()=>import("./Audits-BvE0ZfYT.js"),__vite__mapDeps([8,1,5,2,6,9]))),P=o.lazy(()=>L(()=>import("./Pentest-EPnRfn8-.js"),__vite__mapDeps([10,1,5,2,6,11,12]))),N=o.lazy(()=>L(()=>import("./Feedback-V_oer5Qt.js"),__vite__mapDeps([13,1,5,2,6,11,14]))),R=o.lazy(()=>L(()=>import("./Landing-ar6XmuoC.js"),__vite__mapDeps([15,1,2,6,16]))),C=({children:e})=>{const{isAuthenticated:t,isLoading:o}=w();return o?f.jsxs("div",{className:"loading-container",children:[f.jsx("div",{className:"loading-spinner"}),f.jsx("p",{children:"Loading..."})]}):t?e:f.jsx(i,{to:"/login",replace:!0})},D=({children:e})=>{const{isAuthenticated:t,isLoading:o}=w();return o?f.jsxs("div",{className:"loading-container",children:[f.jsx("div",{className:"loading-spinner"}),f.jsx("p",{children:"Loading..."})]}):t?f.jsx(i,{to:"/dashboard",replace:!0}):e},V=()=>f.jsxs("div",{className:"loading-container",children:[f.jsx("div",{className:"loading-spinner"}),f.jsx("p",{children:"Loading..."})]}),F=()=>f.jsx(r,{children:f.jsx(o.Suspense,{fallback:f.jsx(V,{}),children:f.jsxs(n,{children:[f.jsx(s,{path:"/",element:f.jsx(R,{})}),f.jsx(s,{path:"/login",element:f.jsx(D,{children:f.jsx(I,{})})}),f.jsx(s,{path:"/feedback",element:f.jsx(N,{})}),f.jsx(s,{path:"/dashboard",element:f.jsx(C,{children:f.jsx(O,{})})}),f.jsx(s,{path:"/audits",element:f.jsx(C,{children:f.jsx(b,{})})}),f.jsx(s,{path:"/pentest",element:f.jsx(C,{children:f.jsx(P,{})})}),f.jsx(s,{path:"*",element:f.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[f.jsx("h1",{children:"404"}),f.jsx("p",{children:"Page not found"}),f.jsx("a",{href:"/",children:"Go home"})]})})]})})}),q=()=>f.jsx(k,{children:f.jsx(v,{children:f.jsx(F,{})})}),z=document.getElementById("root");if(!z)throw new Error('Failed to find the root element. Make sure index.html has a div with id="root"');y.createRoot(z).render(f.jsx(o.StrictMode,{children:f.jsx(q,{})}));export{A as a,f as j,w as u};
