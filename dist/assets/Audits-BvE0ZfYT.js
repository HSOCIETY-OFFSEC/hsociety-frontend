import{u as e,j as s}from"./index-Dj-t-wD2.js";import{r as a}from"./react-vendor-Dt--M4EP.js";import{N as t}from"./Navbar-DxjRtyBU.js";import{C as i,B as r}from"./Card-B9fCiNLr.js";import"./ThemeToggle-CQ0JBxkd.js";const l=e=>{if(!e)return"";const s=new Date(e);if(isNaN(s.getTime()))return"";const a=new Date-s,t=Math.floor(a/1e3),i=Math.floor(t/60),r=Math.floor(i/60),l=Math.floor(r/24),n=Math.floor(l/7),d=Math.floor(l/30),c=Math.floor(l/365);return t<60?"just now":i<60?`${i} ${1===i?"minute":"minutes"} ago`:r<24?`${r} ${1===r?"hour":"hours"} ago`:l<7?`${l} ${1===l?"day":"days"} ago`:n<4?`${n} ${1===n?"week":"weeks"} ago`:d<12?`${d} ${1===d?"month":"months"} ago`:`${c} ${1===c?"year":"years"} ago`},n=()=>{const{user:n}=e(),[d,c]=a.useState(!0),[o,m]=a.useState([]),[u,h]=a.useState([]),[j,p]=a.useState(null),[v,x]=a.useState("all"),[g,N]=a.useState("");a.useEffect(()=>{f()},[]),a.useEffect(()=>{y()},[o,v,g]);const f=async()=>{c(!0);try{await new Promise(e=>setTimeout(e,1e3));const e=[{id:"1",title:"Q4 2024 Security Assessment",type:"Web Application",date:Date.now()-432e6,status:"completed",severity:{critical:2,high:5,medium:12,low:8,info:15},remediationProgress:65,tester:"Security Team A",reportAvailable:!0},{id:"2",title:"Network Infrastructure Audit",type:"Network",date:Date.now()-1296e6,status:"in-review",severity:{critical:0,high:3,medium:7,low:5,info:10},remediationProgress:40,tester:"Security Team B",reportAvailable:!1},{id:"3",title:"Mobile App Security Scan",type:"Mobile Application",date:Date.now()-2592e6,status:"completed",severity:{critical:1,high:4,medium:9,low:11,info:20},remediationProgress:100,tester:"Security Team C",reportAvailable:!0},{id:"4",title:"API Security Assessment",type:"API",date:Date.now()-3888e6,status:"completed",severity:{critical:0,high:2,medium:6,low:8,info:12},remediationProgress:85,tester:"Security Team A",reportAvailable:!0}];m(e)}catch(e){console.error("Failed to load audits:",e)}finally{c(!1)}},y=()=>{let e=[...o];if("all"!==v&&(e=e.filter(e=>e.status===v)),g.trim()){const s=g.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(s)||e.type.toLowerCase().includes(s)||e.tester.toLowerCase().includes(s))}h(e)},b=e=>{switch(e){case"critical":return"#dc2626";case"high":return"#f59e0b";case"medium":return"#eab308";case"low":return"#3b82f6";default:return"#6b7280"}},w=e=>{switch(e){case"completed":return"#10b981";case"in-review":return"#f59e0b";default:return"#6b7280"}},S=e=>{switch(e){case"completed":return"Completed";case"in-review":return"In Review";case"draft":return"Draft";default:return"Unknown"}},A=e=>{return s.jsx(i,{hover3d:!0,padding:"large",shadow:"medium",children:s.jsxs("div",{className:"audit-card",children:[s.jsxs("div",{className:"audit-header",children:[s.jsxs("div",{className:"audit-title-section",children:[s.jsx("h3",{className:"audit-title",children:e.title}),s.jsxs("div",{className:"audit-meta",children:[s.jsx("span",{className:"audit-type",children:e.type}),s.jsx("span",{className:"audit-date",children:l(e.date)})]})]}),s.jsx("span",{className:"status-badge",style:{background:`${w(e.status)}20`,color:w(e.status),border:`1px solid ${w(e.status)}50`},children:S(e.status)})]}),s.jsxs("div",{className:"severity-summary",children:[s.jsx("h4",{className:"summary-title",children:"Findings by Severity"}),s.jsx("div",{className:"severity-grid",children:Object.entries(e.severity).map(([e,a])=>s.jsx("div",{className:"severity-item",children:s.jsxs("div",{className:"severity-badge",style:{background:`${b(e)}20`,color:b(e),border:`1px solid ${b(e)}50`},children:[s.jsx("span",{className:"severity-count",children:a}),s.jsx("span",{className:"severity-label",children:e})]})},e))}),s.jsxs("div",{className:"total-findings",children:["Total: ",(a=e.severity,Object.values(a).reduce((e,s)=>e+s,0))," findings"]})]}),"completed"===e.status&&s.jsxs("div",{className:"remediation-section",children:[s.jsxs("div",{className:"remediation-header",children:[s.jsx("span",{className:"remediation-label",children:"Remediation Progress"}),s.jsxs("span",{className:"remediation-percentage",children:[e.remediationProgress,"%"]})]}),s.jsx("div",{className:"progress-bar",children:s.jsx("div",{className:"progress-fill",style:{width:`${e.remediationProgress}%`,background:100===e.remediationProgress?"#10b981":"#f59e0b"}})})]}),s.jsxs("div",{className:"audit-footer",children:[s.jsxs("div",{className:"audit-tester",children:[s.jsx("span",{className:"tester-label",children:"Assessed by:"}),s.jsx("span",{className:"tester-name",children:e.tester})]}),s.jsxs("div",{className:"audit-actions",children:[s.jsx(r,{variant:"secondary",size:"small",onClick:()=>(e=>{p(e)})(e),children:"View Details"}),e.reportAvailable&&s.jsx(r,{variant:"primary",size:"small",onClick:()=>{return s=e.id,console.log("Downloading report for audit:",s),void alert("Download functionality will be implemented with backend integration");var s},children:"ðŸ“¥ Download"})]})]})]})},e.id);var a};return d?s.jsxs(s.Fragment,{children:[s.jsx(t,{}),s.jsx("div",{className:"audits-container",children:s.jsxs("div",{className:"loading-state",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Loading audits..."})]})})]}):s.jsxs(s.Fragment,{children:[s.jsx(t,{}),s.jsx("div",{className:"audits-container",children:s.jsxs("div",{className:"audits-wrapper",children:[s.jsx("div",{className:"page-header",children:s.jsxs("div",{children:[s.jsx("h1",{className:"page-title",children:"Security Audits"}),s.jsx("p",{className:"page-subtitle",children:"View and manage security audit reports and vulnerability assessments"})]})}),s.jsx(i,{padding:"medium",shadow:"small",children:s.jsxs("div",{className:"filters-section",children:[s.jsxs("div",{className:"search-box",children:[s.jsx("span",{className:"search-icon",children:"ðŸ”"}),s.jsx("input",{type:"text",placeholder:"Search audits...",value:g,onChange:e=>N(e.target.value),className:"search-input"})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Status:"}),s.jsxs("div",{className:"filter-buttons",children:[s.jsx("button",{className:"filter-button "+("all"===v?"active":""),onClick:()=>x("all"),children:"All"}),s.jsx("button",{className:"filter-button "+("completed"===v?"active":""),onClick:()=>x("completed"),children:"Completed"}),s.jsx("button",{className:"filter-button "+("in-review"===v?"active":""),onClick:()=>x("in-review"),children:"In Review"})]})]})]})}),s.jsx("div",{className:"results-info",children:s.jsxs("p",{children:["Showing ",s.jsx("strong",{children:u.length})," of ",s.jsx("strong",{children:o.length})," audits"]})}),0===u.length?s.jsx(i,{padding:"large",children:s.jsxs("div",{className:"empty-state",children:[s.jsx("span",{style:{fontSize:"3rem"},children:"ðŸ“‹"}),s.jsx("h3",{children:"No audits found"}),s.jsx("p",{children:g?"Try adjusting your search query or filters.":"No security audits available at the moment."})]})}):s.jsx("div",{className:"audits-grid",children:u.map(e=>A(e))})]})})]})};export{n as default};
