import{u as e,j as a,L as s}from"./index-C70WDyyI.js";import{u as t,r}from"./react-vendor-Dt--M4EP.js";import{C as i,F as l,B as o,a as n}from"./Card-BJrnA0Es.js";import"./icons-9q4Ww-N4.js";const c=()=>{const c=t(),{login:d}=e(),[u,m]=r.useState(1),[h,p]=r.useState(""),[j,x]=r.useState("corporate"),[f,g]=r.useState(""),[y,v]=r.useState(""),[b,N]=r.useState(!1),[P,T]=r.useState(""),w=async()=>{try{const e={id:"1",email:h,name:"Test User",role:j},a="mock-jwt-token-"+Date.now();await d(e,a),c("student"===j?"/student-dashboard":"/dashboard")}catch(e){T("Login failed. Please try again."),console.error("Login error:",e)}},F=()=>{m(1),p(""),g(""),v(""),T(""),x("corporate")};return a.jsx("div",{className:"auth-container",children:a.jsxs("div",{className:"auth-wrapper",children:[a.jsx("div",{className:"auth-logo",children:a.jsx(s,{size:"large"})}),a.jsxs(i,{className:"auth-card",children:[a.jsxs("div",{className:"auth-header",children:[a.jsx("h1",{children:"Secure Login"}),a.jsxs("p",{className:"auth-subtitle",children:[1===u&&"Enter your email to receive a one-time password",2===u&&"Enter the OTP sent to your email",3===u&&"Enter your 2FA authentication code"]})]}),P&&a.jsxs("div",{className:"auth-error",children:[a.jsx("span",{className:"error-icon",children:a.jsx(l,{size:16})}),P]}),1===u&&a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),T("");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)){N(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("OTP requested for:",h),m(2)}catch(a){T("Failed to send OTP. Please try again."),console.error("OTP request error:",a)}finally{N(!1)}}else T("Please enter a valid email address")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Account Type"}),a.jsxs("div",{className:"auth-toggle",children:[a.jsx("button",{type:"button",className:"corporate"===j?"active":"",onClick:()=>x("corporate"),disabled:b,children:"Corporate"}),a.jsx("button",{type:"button",className:"student"===j?"active":"",onClick:()=>x("student"),disabled:b,children:"Student"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email Address"}),a.jsx("input",{type:"email",id:"email",value:h,onChange:e=>p(e.target.value),placeholder:"you@example.com",required:!0,autoFocus:!0,disabled:b,className:"form-input"})]}),a.jsx(o,{type:"submit",variant:"primary",fullWidth:!0,loading:b,disabled:b,children:b?"Sending OTP...":"Request OTP"})]}),2===u&&a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),T(""),6===f.length){N(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("OTP verified:",f);!0&&m(3)}catch(a){T("Invalid OTP. Please try again."),console.error("OTP verification error:",a)}finally{N(!1)}}else T("OTP must be 6 digits")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"otp",children:"One-Time Password"}),a.jsx("input",{type:"text",id:"otp",value:f,onChange:e=>g(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,required:!0,autoFocus:!0,disabled:b,className:"form-input otp-input"}),a.jsx("span",{className:"form-hint",children:"Check your email for the 6-digit code"})]}),a.jsx(o,{type:"submit",variant:"primary",fullWidth:!0,loading:b,disabled:b||6!==f.length,children:b?"Verifying...":"Verify OTP"}),a.jsx("button",{type:"button",onClick:F,className:"auth-link",disabled:b,children:"Use a different email"})]}),3===u&&a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),T(""),6===y.length){N(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("2FA verified:",y),await w()}catch(a){T("Invalid 2FA code. Please try again."),console.error("2FA verification error:",a)}finally{N(!1)}}else T("2FA code must be 6 digits")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"twofa",children:"Two-Factor Authentication"}),a.jsx("input",{type:"text",id:"twofa",value:y,onChange:e=>v(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,required:!0,autoFocus:!0,disabled:b,className:"form-input otp-input"}),a.jsx("span",{className:"form-hint",children:"Enter code from your authenticator app"})]}),a.jsx(o,{type:"submit",variant:"primary",fullWidth:!0,loading:b,disabled:b||6!==y.length,children:b?"Verifying...":"Verify 2FA"}),a.jsx("button",{type:"button",onClick:F,className:"auth-link",disabled:b,children:"Start over"})]}),a.jsx("div",{className:"auth-footer",children:a.jsxs("p",{children:["Don't have an account?"," ",a.jsx("button",{onClick:()=>c("/register"),className:"auth-link-inline",disabled:b,children:"Register here"})]})})]}),a.jsx("div",{className:"auth-notice",children:a.jsxs("p",{children:[a.jsx("span",{className:"notice-icon",children:a.jsx(n,{size:16})}),"Your security is our priority. All communications are encrypted."]})})]})})};export{c as default};
