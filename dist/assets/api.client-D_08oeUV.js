import"./env.config-sfTiOdmx.js";import{s as t}from"./index-3VLiaMkN.js";const e={AUTH:{LOGIN:"/auth/login",REGISTER:"/auth/register",LOGOUT:"/auth/logout",REFRESH:"/auth/refresh",VERIFY:"/auth/verify",ME:"/auth/me",PASSWORD_RESET_REQUEST:"/auth/password-reset/request",PASSWORD_RESET_CONFIRM:"/auth/password-reset/confirm",CHANGE_PASSWORD:"/auth/change-password"},OTP:{REQUEST:"/auth/otp/request",VERIFY:"/auth/otp/verify",RESEND:"/auth/otp/resend"},TWO_FA:{SETUP:"/auth/2fa/setup",VERIFY:"/auth/2fa/verify",ENABLE:"/auth/2fa/enable",DISABLE:"/auth/2fa/disable",VERIFY_BACKUP:"/auth/2fa/verify-backup",REGENERATE_BACKUP:"/auth/2fa/regenerate-backup",STATUS:"/auth/2fa/status"},PROFILE:{GET:"/profile",UPDATE:"/profile",DELETE:"/profile",AVATAR:"/profile/avatar"},DASHBOARD:{STATS:"/dashboard/stats",ACTIVITY:"/dashboard/activity",OVERVIEW:"/dashboard/overview"},PENTEST:{LIST:"/pentest",CREATE:"/pentest",GET:"/pentest/:id",UPDATE:"/pentest/:id",DELETE:"/pentest/:id",SUBMIT:"/pentest/:id/submit",CANCEL:"/pentest/:id/cancel",REPORTS:"/pentest/:id/reports"},AUDITS:{LIST:"/audits",CREATE:"/audits",GET:"/audits/:id",UPDATE:"/audits/:id",DELETE:"/audits/:id",DOWNLOAD:"/audits/:id/download",HISTORY:"/audits/:id/history"},FEEDBACK:{SUBMIT:"/feedback",LIST:"/feedback",GET:"/feedback/:id"},COMMUNITY:{OVERVIEW:"/community/overview",POSTS:"/community/posts",POST_BY_ID:"/community/posts/:id",POST_REACT:"/community/posts/:id/react",POST_SAVE:"/community/posts/:id/save",CHANNELS:"/community/channels",TAGS:"/community/tags",MENTORS:"/community/mentors",CHALLENGES:"/community/challenges"},FILES:{UPLOAD:"/files/upload",DOWNLOAD:"/files/:id/download",DELETE:"/files/:id"},NOTIFICATIONS:{LIST:"/notifications",GET:"/notifications/:id",MARK_READ:"/notifications/:id/read",MARK_ALL_READ:"/notifications/read-all",DELETE:"/notifications/:id"},ADMIN:{USERS:"/admin/users",REPORTS:"/admin/reports",SETTINGS:"/admin/settings"}},s=(t,e={})=>{let s=t;return Object.keys(e).forEach(t=>{s=s.replace(`:${t}`,e[t])}),s},a={GET:"GET",POST:"POST",PUT:"PUT",PATCH:"PATCH",DELETE:"DELETE"};const o=new class{constructor(t="http://localhost:3000/api"){this.baseURL=t,this.defaultHeaders={"Content-Type":"application/json",Accept:"application/json"}}getAuthToken(){return t.getToken()}buildURL(t){const e=t.startsWith("/")?t:`/${t}`;return`${this.baseURL}${e}`}buildHeaders(t={}){const e={...this.defaultHeaders,...t},s=this.getAuthToken();return s&&(e.Authorization=`Bearer ${s}`),e}handleError(e,s){if(console.error(`[API] Error on ${s}:`,e),!e.response)return{success:!1,error:"Network error. Please check your connection.",status:0};const{status:a,data:o}=e.response;return 401===a?(t.clearSession(),window.location.href="/login",{success:!1,error:"Session expired. Please login again.",status:401}):{success:!1,error:(null==o?void 0:o.message)||"An error occurred",status:a,data:o}}async request(t,e,s=null,o={}){const r=this.buildURL(e),n={method:t,headers:this.buildHeaders(o.headers),...o};s&&[a.POST,a.PUT,a.PATCH].includes(t)&&(n.body=JSON.stringify(s));try{console.log(`[API] ${t} ${e}`);const s=await fetch(r,n);let a;const o=s.headers.get("content-type");if(a=o&&o.includes("application/json")?await s.json():await s.text(),!s.ok)throw{response:{status:s.status,data:a}};return console.log(`[API] ${t} ${e} - Success`),{success:!0,data:a,status:s.status}}catch(i){return this.handleError(i,e)}}async get(t,e={}){return this.request(a.GET,t,null,e)}async post(t,e,s={}){return this.request(a.POST,t,e,s)}async put(t,e,s={}){return this.request(a.PUT,t,e,s)}async patch(t,e,s={}){return this.request(a.PATCH,t,e,s)}async delete(t,e={}){return this.request(a.DELETE,t,null,e)}async upload(t,e,s="file",a={}){const o=this.buildURL(t),r=this.getAuthToken(),n=new FormData;n.append(s,e),Object.keys(a).forEach(t=>{n.append(t,a[t])});const i={};r&&(i.Authorization=`Bearer ${r}`);try{console.log(`[API] Upload to ${t}`);const e=await fetch(o,{method:"POST",headers:i,body:n}),s=await e.json();if(!e.ok)throw{response:{status:e.status,data:s}};return console.log(`[API] Upload to ${t} - Success`),{success:!0,data:s,status:e.status}}catch(c){return this.handleError(c,t)}}async download(t,e){const s=this.buildURL(t),a=this.getAuthToken(),o={};a&&(o.Authorization=`Bearer ${a}`);try{console.log(`[API] Download from ${t}`);const a=await fetch(s,{headers:o});if(!a.ok)throw new Error("Download failed");const r=await a.blob(),n=window.URL.createObjectURL(r),i=document.createElement("a");return i.href=n,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n),console.log(`[API] Download from ${t} - Success`),{success:!0,message:"File downloaded successfully"}}catch(r){return console.error("[API] Download failed:",r),{success:!1,error:"Failed to download file"}}}};export{e as A,o as a,s as b};
