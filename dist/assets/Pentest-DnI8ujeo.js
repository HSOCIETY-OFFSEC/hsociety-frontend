import{u as e,j as s}from"./index-C0y2O-DG.js";import{r as a}from"./react-vendor-Dt--M4EP.js";import{g as t,h as r,i,C as l,j as n,F as c,B as d,k as o}from"./Card-BuSz5BGb.js";import{N as m}from"./Navbar-BVJCGEJf.js";import{u as p}from"./ThemeToggle-J-qBBjf6.js";import{S as h}from"./Skeleton-DsKHMcMe.js";import{v as u}from"./input.validator-7PKJK-co.js";import"./icons-9q4Ww-N4.js";const g=()=>{const{user:g}=e(),[x,j]=a.useState("request"),[v,N]=a.useState(!1),[f,y]=a.useState([]),[b,w]=a.useState({targetType:"web-application",targetUrl:"",targetDescription:"",scope:"",preferredDate:"",urgency:"normal",additionalNotes:""}),[D,S]=a.useState({}),[q,T]=a.useState(!1);p(".reveal-on-scroll",{},[x,v,f.length]),a.useEffect(()=>{"request"!==x&&C()},[x]);const C=async()=>{N(!0);try{await new Promise(e=>setTimeout(e,1e3));const e=[{id:"1",type:"Web Application",target:"https://example.com",status:"in-progress",startDate:Date.now()-432e6,estimatedCompletion:Date.now()+864e6,tester:"Security Team A"},{id:"2",type:"Network Infrastructure",target:"192.168.1.0/24",status:"completed",startDate:Date.now()-2592e6,completedDate:Date.now()-1296e6,tester:"Security Team B",reportAvailable:!0},{id:"3",type:"Mobile Application",target:"Android App v2.1",status:"scheduled",scheduledDate:Date.now()+6048e5,tester:"Security Team C"}];y(e)}catch(e){console.error("Failed to load engagements:",e)}finally{N(!1)}},k=e=>{const{name:s,value:a}=e.target;w(e=>({...e,[s]:a})),D[s]&&S(e=>({...e,[s]:""}))},A=async e=>{e.preventDefault(),S({}),T(!1);const s=u(b,{targetUrl:{required:!0,type:"url"},targetDescription:{required:!0,minLength:20},scope:{required:!0,minLength:10},preferredDate:{required:!0}});if(s.isValid){N(!0);try{await new Promise(e=>setTimeout(e,1500)),console.log("Pentest request submitted:",s.sanitizedData),T(!0),w({targetType:"web-application",targetUrl:"",targetDescription:"",scope:"",preferredDate:"",urgency:"normal",additionalNotes:""}),setTimeout(()=>{j("active")},2e3)}catch(a){S({submit:"Failed to submit request. Please try again."}),console.error("Pentest request failed:",a)}finally{N(!1)}}else S(s.errors)},U=e=>{switch(e){case"scheduled":return"#3b82f6";case"in-progress":return"#f59e0b";case"completed":return"#10b981";case"cancelled":return"#ef4444";default:return"#6b7280"}},P=e=>{switch(e){case"scheduled":return"Scheduled";case"in-progress":return"In Progress";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return"Unknown"}},F=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),R=e=>{const a="active"===e?f.filter(e=>["scheduled","in-progress"].includes(e.status)):f.filter(e=>["completed","cancelled"].includes(e.status));return v?s.jsx("div",{className:"engagements-grid",children:[...Array(3)].map((e,a)=>s.jsx(l,{padding:"large",shadow:"medium",children:s.jsxs("div",{className:"engagement-card",children:[s.jsxs("div",{className:"engagement-header",children:[s.jsx(h,{className:"skeleton-line",style:{width:"180px"}}),s.jsx(h,{className:"skeleton-line",style:{width:"90px",height:"20px"}})]}),s.jsx("div",{className:"engagement-details",children:[...Array(3)].map((e,a)=>s.jsxs("div",{className:"detail-item",children:[s.jsx(h,{className:"skeleton-line",style:{width:"80px"}}),s.jsx(h,{className:"skeleton-line",style:{width:"140px"}})]},a))}),s.jsxs("div",{className:"engagement-footer",children:[s.jsx(h,{className:"skeleton-line",style:{width:"140px"}}),s.jsx(h,{className:"skeleton-rect",style:{width:"110px",height:"36px",borderRadius:"8px"}})]})]})},a))}):0===a.length?s.jsx(l,{padding:"large",children:s.jsxs("div",{className:"empty-state",children:[s.jsx("span",{style:{fontSize:"3rem",display:"inline-flex"},children:s.jsx(o,{size:40})}),s.jsxs("h3",{children:["No ",e," engagements"]}),s.jsx("p",{children:"active"===e?"You have no active or scheduled penetration tests.":"You have no completed penetration tests."}),"active"===e&&s.jsx(d,{variant:"primary",onClick:()=>j("request"),style:{marginTop:"1rem"},children:"Request New Pentest"})]})}):s.jsx("div",{className:"engagements-grid",children:a.map(e=>s.jsx(l,{hover3d:!0,padding:"large",shadow:"medium",children:s.jsxs("div",{className:"engagement-card",children:[s.jsxs("div",{className:"engagement-header",children:[s.jsx("h3",{className:"engagement-title",children:e.type}),s.jsx("span",{className:"status-badge",style:{background:`${U(e.status)}20`,color:U(e.status),border:`1px solid ${U(e.status)}50`},children:P(e.status)})]}),s.jsxs("div",{className:"engagement-details",children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Target:"}),s.jsx("span",{className:"detail-value",children:e.target})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Tester:"}),s.jsx("span",{className:"detail-value",children:e.tester})]}),"scheduled"===e.status&&s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Scheduled:"}),s.jsx("span",{className:"detail-value",children:F(e.scheduledDate)})]}),"in-progress"===e.status&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Started:"}),s.jsx("span",{className:"detail-value",children:F(e.startDate)})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Est. Completion:"}),s.jsx("span",{className:"detail-value",children:F(e.estimatedCompletion)})]})]}),"completed"===e.status&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Completed:"}),s.jsx("span",{className:"detail-value",children:F(e.completedDate)})]}),e.reportAvailable&&s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Report:"}),s.jsx("span",{className:"detail-value",children:s.jsx(d,{variant:"ghost",size:"small",children:"Download Report â†’"})})]})]})]}),s.jsx("div",{className:"engagement-actions",children:s.jsx(d,{variant:"secondary",size:"small",fullWidth:!0,children:"View Details"})})]})},e.id))})};return s.jsxs(s.Fragment,{children:[s.jsx(m,{}),s.jsx("div",{className:"pentest-container",children:s.jsxs("div",{className:"pentest-wrapper",children:[s.jsx("div",{className:"page-header reveal-on-scroll",children:s.jsxs("div",{children:[s.jsx("h1",{className:"page-title",children:"Penetration Testing"}),s.jsx("p",{className:"page-subtitle",children:"Request and manage security penetration testing engagements"})]})}),s.jsxs("div",{className:"tabs-container reveal-on-scroll",children:[s.jsxs("button",{className:"tab "+("request"===x?"active":""),onClick:()=>j("request"),children:[s.jsx(t,{size:16}),"Request New Test"]}),s.jsxs("button",{className:"tab "+("active"===x?"active":""),onClick:()=>j("active"),children:[s.jsx(r,{size:16}),"Active Engagements"]}),s.jsxs("button",{className:"tab "+("history"===x?"active":""),onClick:()=>j("history"),children:[s.jsx(i,{size:16}),"History"]})]}),s.jsxs("div",{className:"tab-content reveal-on-scroll",children:["request"===x&&s.jsxs(l,{padding:"large",shadow:"medium",children:[s.jsx("h2",{className:"section-title",children:"Request Penetration Test"}),s.jsx("p",{className:"section-subtitle",children:"Submit a request for our security team to conduct a comprehensive penetration test"}),q&&s.jsxs("div",{className:"success-message",children:[s.jsx("span",{className:"success-icon",children:s.jsx(n,{size:18})}),s.jsxs("div",{children:[s.jsx("strong",{children:"Request submitted successfully!"}),s.jsx("p",{children:"Our team will review your request and contact you within 24-48 hours."})]})]}),D.submit&&s.jsxs("div",{className:"error-message",children:[s.jsx("span",{className:"error-icon",children:s.jsx(c,{size:18})}),D.submit]}),s.jsxs("form",{onSubmit:A,className:"pentest-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"targetType",children:"Target Type *"}),s.jsxs("select",{id:"targetType",name:"targetType",value:b.targetType,onChange:k,className:"form-input",required:!0,children:[s.jsx("option",{value:"web-application",children:"Web Application"}),s.jsx("option",{value:"mobile-application",children:"Mobile Application"}),s.jsx("option",{value:"api",children:"API"}),s.jsx("option",{value:"network",children:"Network Infrastructure"}),s.jsx("option",{value:"physical",children:"Physical Security"}),s.jsx("option",{value:"social-engineering",children:"Social Engineering"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"targetUrl",children:"Target URL/Identifier *"}),s.jsx("input",{type:"text",id:"targetUrl",name:"targetUrl",value:b.targetUrl,onChange:k,placeholder:"https://example.com or 192.168.1.0/24",className:"form-input "+(D.targetUrl?"error":""),required:!0}),D.targetUrl&&s.jsx("span",{className:"field-error",children:D.targetUrl})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"targetDescription",children:"Target Description *"}),s.jsx("textarea",{id:"targetDescription",name:"targetDescription",value:b.targetDescription,onChange:k,placeholder:"Describe the target system, its purpose, and key features...",rows:4,className:"form-input "+(D.targetDescription?"error":""),required:!0}),D.targetDescription&&s.jsx("span",{className:"field-error",children:D.targetDescription}),s.jsx("span",{className:"field-hint",children:"Minimum 20 characters"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"scope",children:"Testing Scope *"}),s.jsx("textarea",{id:"scope",name:"scope",value:b.scope,onChange:k,placeholder:"Define what should and should not be tested. Include specific URLs, IP ranges, or features...",rows:4,className:"form-input "+(D.scope?"error":""),required:!0}),D.scope&&s.jsx("span",{className:"field-error",children:D.scope}),s.jsx("span",{className:"field-hint",children:"Be specific about in-scope and out-of-scope items"})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"preferredDate",children:"Preferred Start Date *"}),s.jsx("input",{type:"date",id:"preferredDate",name:"preferredDate",value:b.preferredDate,onChange:k,min:(new Date).toISOString().split("T")[0],className:"form-input "+(D.preferredDate?"error":""),required:!0}),D.preferredDate&&s.jsx("span",{className:"field-error",children:D.preferredDate})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"urgency",children:"Urgency Level"}),s.jsxs("select",{id:"urgency",name:"urgency",value:b.urgency,onChange:k,className:"form-input",children:[s.jsx("option",{value:"low",children:"Low - Routine Assessment"}),s.jsx("option",{value:"normal",children:"Normal - Standard Timeline"}),s.jsx("option",{value:"high",children:"High - Priority Engagement"}),s.jsx("option",{value:"critical",children:"Critical - Urgent Security Concern"})]})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"additionalNotes",children:"Additional Notes (Optional)"}),s.jsx("textarea",{id:"additionalNotes",name:"additionalNotes",value:b.additionalNotes,onChange:k,placeholder:"Any additional information, special requirements, or constraints...",rows:3,className:"form-input"})]}),s.jsx("div",{className:"form-actions",children:s.jsx(d,{type:"submit",variant:"primary",size:"large",loading:v,disabled:v,children:v?"Submitting...":"Submit Request"})})]})]}),"active"===x&&R("active"),"history"===x&&R("history")]})]})})]})};export{g as default};
