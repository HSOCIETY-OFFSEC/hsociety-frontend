import{u as e,j as a,L as s}from"./index-C0y2O-DG.js";import{u as i,r as t}from"./react-vendor-Dt--M4EP.js";import{C as r,F as l,B as n,a as o}from"./Card-BuSz5BGb.js";import"./icons-9q4Ww-N4.js";const c=()=>{const c=i(),{login:d}=e(),[u,m]=t.useState(1),[h,p]=t.useState(""),[f,x]=t.useState(""),[j,g]=t.useState(""),[y,v]=t.useState(!1),[b,N]=t.useState(""),P=async()=>{try{const e={id:"1",email:h,name:"Test User",role:"client"},a="mock-jwt-token-"+Date.now();await d(e,a),c("/dashboard")}catch(e){N("Login failed. Please try again."),console.error("Login error:",e)}},T=()=>{m(1),p(""),x(""),g(""),N("")};return a.jsx("div",{className:"auth-container",children:a.jsxs("div",{className:"auth-wrapper",children:[a.jsx("div",{className:"auth-logo",children:a.jsx(s,{size:"large"})}),a.jsxs(r,{className:"auth-card",children:[a.jsxs("div",{className:"auth-header",children:[a.jsx("h1",{children:"Secure Login"}),a.jsxs("p",{className:"auth-subtitle",children:[1===u&&"Enter your email to receive a one-time password",2===u&&"Enter the OTP sent to your email",3===u&&"Enter your 2FA authentication code"]})]}),b&&a.jsxs("div",{className:"auth-error",children:[a.jsx("span",{className:"error-icon",children:a.jsx(l,{size:16})}),b]}),1===u&&a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),N("");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)){v(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("OTP requested for:",h),m(2)}catch(a){N("Failed to send OTP. Please try again."),console.error("OTP request error:",a)}finally{v(!1)}}else N("Please enter a valid email address")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email Address"}),a.jsx("input",{type:"email",id:"email",value:h,onChange:e=>p(e.target.value),placeholder:"you@example.com",required:!0,autoFocus:!0,disabled:y,className:"form-input"})]}),a.jsx(n,{type:"submit",variant:"primary",fullWidth:!0,loading:y,disabled:y,children:y?"Sending OTP...":"Request OTP"})]}),2===u&&a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),N(""),6===f.length){v(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("OTP verified:",f);!0&&m(3)}catch(a){N("Invalid OTP. Please try again."),console.error("OTP verification error:",a)}finally{v(!1)}}else N("OTP must be 6 digits")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"otp",children:"One-Time Password"}),a.jsx("input",{type:"text",id:"otp",value:f,onChange:e=>x(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,required:!0,autoFocus:!0,disabled:y,className:"form-input otp-input"}),a.jsx("span",{className:"form-hint",children:"Check your email for the 6-digit code"})]}),a.jsx(n,{type:"submit",variant:"primary",fullWidth:!0,loading:y,disabled:y||6!==f.length,children:y?"Verifying...":"Verify OTP"}),a.jsx("button",{type:"button",onClick:T,className:"auth-link",disabled:y,children:"Use a different email"})]}),3===u&&a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),N(""),6===j.length){v(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("2FA verified:",j),await P()}catch(a){N("Invalid 2FA code. Please try again."),console.error("2FA verification error:",a)}finally{v(!1)}}else N("2FA code must be 6 digits")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"twofa",children:"Two-Factor Authentication"}),a.jsx("input",{type:"text",id:"twofa",value:j,onChange:e=>g(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,required:!0,autoFocus:!0,disabled:y,className:"form-input otp-input"}),a.jsx("span",{className:"form-hint",children:"Enter code from your authenticator app"})]}),a.jsx(n,{type:"submit",variant:"primary",fullWidth:!0,loading:y,disabled:y||6!==j.length,children:y?"Verifying...":"Verify 2FA"}),a.jsx("button",{type:"button",onClick:T,className:"auth-link",disabled:y,children:"Start over"})]}),a.jsx("div",{className:"auth-footer",children:a.jsxs("p",{children:["Don't have an account?"," ",a.jsx("button",{onClick:()=>c("/register"),className:"auth-link-inline",disabled:y,children:"Register here"})]})})]}),a.jsx("div",{className:"auth-notice",children:a.jsxs("p",{children:[a.jsx("span",{className:"notice-icon",children:a.jsx(o,{size:16})}),"Your security is our priority. All communications are encrypted."]})})]})})};export{c as default};
