import{u as e,j as a}from"./index-Dj-t-wD2.js";import{u as s,r as t}from"./react-vendor-Dt--M4EP.js";import{L as r,C as i,B as l}from"./Card-B9fCiNLr.js";const n=()=>{const n=s(),{login:o}=e(),[c,d]=t.useState(1),[u,m]=t.useState(""),[h,p]=t.useState(""),[f,g]=t.useState(""),[x,j]=t.useState(!1),[y,v]=t.useState(""),b=async()=>{try{const e={id:"1",email:u,name:"Test User",role:"client"},a="mock-jwt-token-"+Date.now();await o(e,a),n("/dashboard")}catch(e){v("Login failed. Please try again."),console.error("Login error:",e)}},N=()=>{d(1),m(""),p(""),g(""),v("")};return a.jsx("div",{className:"auth-container",children:a.jsxs("div",{className:"auth-wrapper",children:[a.jsx("div",{className:"auth-logo",children:a.jsx(r,{size:"large"})}),a.jsxs(i,{className:"auth-card",children:[a.jsxs("div",{className:"auth-header",children:[a.jsx("h1",{children:"Secure Login"}),a.jsxs("p",{className:"auth-subtitle",children:[1===c&&"Enter your email to receive a one-time password",2===c&&"Enter the OTP sent to your email",3===c&&"Enter your 2FA authentication code"]})]}),y&&a.jsxs("div",{className:"auth-error",children:[a.jsx("span",{className:"error-icon",children:"âš "}),y]}),1===c&&a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),v("");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)){j(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("OTP requested for:",u),d(2)}catch(a){v("Failed to send OTP. Please try again."),console.error("OTP request error:",a)}finally{j(!1)}}else v("Please enter a valid email address")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email Address"}),a.jsx("input",{type:"email",id:"email",value:u,onChange:e=>m(e.target.value),placeholder:"you@example.com",required:!0,autoFocus:!0,disabled:x,className:"form-input"})]}),a.jsx(l,{type:"submit",variant:"primary",fullWidth:!0,loading:x,disabled:x,children:x?"Sending OTP...":"Request OTP"})]}),2===c&&a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),v(""),6===h.length){j(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("OTP verified:",h);!0&&d(3)}catch(a){v("Invalid OTP. Please try again."),console.error("OTP verification error:",a)}finally{j(!1)}}else v("OTP must be 6 digits")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"otp",children:"One-Time Password"}),a.jsx("input",{type:"text",id:"otp",value:h,onChange:e=>p(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,required:!0,autoFocus:!0,disabled:x,className:"form-input otp-input"}),a.jsx("span",{className:"form-hint",children:"Check your email for the 6-digit code"})]}),a.jsx(l,{type:"submit",variant:"primary",fullWidth:!0,loading:x,disabled:x||6!==h.length,children:x?"Verifying...":"Verify OTP"}),a.jsx("button",{type:"button",onClick:N,className:"auth-link",disabled:x,children:"Use a different email"})]}),3===c&&a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),v(""),6===f.length){j(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("2FA verified:",f),await b()}catch(a){v("Invalid 2FA code. Please try again."),console.error("2FA verification error:",a)}finally{j(!1)}}else v("2FA code must be 6 digits")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"twofa",children:"Two-Factor Authentication"}),a.jsx("input",{type:"text",id:"twofa",value:f,onChange:e=>g(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,required:!0,autoFocus:!0,disabled:x,className:"form-input otp-input"}),a.jsx("span",{className:"form-hint",children:"Enter code from your authenticator app"})]}),a.jsx(l,{type:"submit",variant:"primary",fullWidth:!0,loading:x,disabled:x||6!==f.length,children:x?"Verifying...":"Verify 2FA"}),a.jsx("button",{type:"button",onClick:N,className:"auth-link",disabled:x,children:"Start over"})]}),a.jsx("div",{className:"auth-footer",children:a.jsxs("p",{children:["Don't have an account?"," ",a.jsx("button",{onClick:()=>n("/register"),className:"auth-link-inline",disabled:x,children:"Register here"})]})})]}),a.jsx("div",{className:"auth-notice",children:a.jsx("p",{children:"ðŸ”’ Your security is our priority. All communications are encrypted."})})]})})};export{n as default};
