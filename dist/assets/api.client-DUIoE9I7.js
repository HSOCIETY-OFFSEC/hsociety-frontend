import{s as e}from"./index-BKTFHamk.js";const t={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},s=(e,s="")=>void 0!==import.meta&&t&&t[e]||s,a={mode:s("MODE","development"),api:{baseURL:s("VITE_API_BASE_URL","http://localhost:3000/api"),timeout:parseInt(s("VITE_API_TIMEOUT","30000")),version:s("VITE_API_VERSION","v1")},auth:{tokenKey:s("VITE_AUTH_TOKEN_KEY","hsociety_token"),sessionDuration:parseInt(s("VITE_SESSION_DURATION","86400000")),inactivityTimeout:parseInt(s("VITE_INACTIVITY_TIMEOUT","900000")),enableTwoFA:"true"===s("VITE_ENABLE_2FA","true")},security:{enableEncryption:"true"===s("VITE_ENABLE_ENCRYPTION","false"),encryptionKey:s("VITE_ENCRYPTION_KEY",""),enableCSRF:"true"===s("VITE_ENABLE_CSRF","true"),enableRateLimiting:"true"===s("VITE_ENABLE_RATE_LIMITING","true")},features:{enablePentest:"true"===s("VITE_FEATURE_PENTEST","true"),enableAudits:"true"===s("VITE_FEATURE_AUDITS","true"),enableFeedback:"true"===s("VITE_FEATURE_FEEDBACK","true"),enableNotifications:"true"===s("VITE_FEATURE_NOTIFICATIONS","true"),enableFileUpload:"true"===s("VITE_FEATURE_FILE_UPLOAD","true")},upload:{maxFileSize:parseInt(s("VITE_MAX_FILE_SIZE","5242880")),allowedTypes:s("VITE_ALLOWED_FILE_TYPES","image/jpeg,image/png,application/pdf").split(",")},analytics:{enabled:"true"===s("VITE_ANALYTICS_ENABLED","false"),trackingId:s("VITE_ANALYTICS_TRACKING_ID","")},logging:{level:s("VITE_LOG_LEVEL","info"),enableConsole:"true"===s("VITE_LOG_CONSOLE","true"),enableRemote:"true"===s("VITE_LOG_REMOTE","false")},app:{name:s("VITE_APP_NAME","HSOCIETY"),version:s("VITE_APP_VERSION","1.0.0"),description:s("VITE_APP_DESCRIPTION","Offensive Security Platform")}},o=()=>{const e=["VITE_API_BASE_URL"].filter(e=>!s(e));if(e.length>0&&(console.warn("[ENV] Missing required environment variables:",e),"production"===s("MODE")||"production"===s("VITE_MODE")))throw new Error(`Missing required environment variables: ${e.join(", ")}`);console.log("[ENV] Environment configuration loaded:",{mode:a.mode,apiBaseURL:a.api.baseURL,features:a.features})};"development"!==s("MODE")&&"development"!==s("VITE_MODE")||o();const n={AUTH:{LOGIN:"/auth/login",REGISTER:"/auth/register",LOGOUT:"/auth/logout",REFRESH:"/auth/refresh",VERIFY:"/auth/verify",ME:"/auth/me",PASSWORD_RESET_REQUEST:"/auth/password-reset/request",PASSWORD_RESET_CONFIRM:"/auth/password-reset/confirm",CHANGE_PASSWORD:"/auth/change-password"},OTP:{REQUEST:"/auth/otp/request",VERIFY:"/auth/otp/verify",RESEND:"/auth/otp/resend"},TWO_FA:{SETUP:"/auth/2fa/setup",VERIFY:"/auth/2fa/verify",ENABLE:"/auth/2fa/enable",DISABLE:"/auth/2fa/disable",VERIFY_BACKUP:"/auth/2fa/verify-backup",REGENERATE_BACKUP:"/auth/2fa/regenerate-backup",STATUS:"/auth/2fa/status"},PROFILE:{GET:"/profile",UPDATE:"/profile",DELETE:"/profile",AVATAR:"/profile/avatar"},DASHBOARD:{STATS:"/dashboard/stats",ACTIVITY:"/dashboard/activity",OVERVIEW:"/dashboard/overview"},STUDENT:{OVERVIEW:"/student/overview",LEARNING_PATH:"/student/learning-path",CHALLENGES:"/student/challenges",MENTORS:"/student/mentors",SNAPSHOT:"/student/snapshot"},PENTEST:{LIST:"/pentest",CREATE:"/pentest",GET:"/pentest/:id",UPDATE:"/pentest/:id",DELETE:"/pentest/:id",SUBMIT:"/pentest/:id/submit",CANCEL:"/pentest/:id/cancel",REPORTS:"/pentest/:id/reports"},AUDITS:{LIST:"/audits",CREATE:"/audits",GET:"/audits/:id",UPDATE:"/audits/:id",DELETE:"/audits/:id",DOWNLOAD:"/audits/:id/download",HISTORY:"/audits/:id/history"},FEEDBACK:{SUBMIT:"/feedback",LIST:"/feedback",GET:"/feedback/:id"},COMMUNITY:{OVERVIEW:"/community/overview",POSTS:"/community/posts",POST_BY_ID:"/community/posts/:id",POST_REACT:"/community/posts/:id/react",POST_SAVE:"/community/posts/:id/save",CHANNELS:"/community/channels",TAGS:"/community/tags",MENTORS:"/community/mentors",CHALLENGES:"/community/challenges"},FILES:{UPLOAD:"/files/upload",DOWNLOAD:"/files/:id/download",DELETE:"/files/:id"},NOTIFICATIONS:{LIST:"/notifications",GET:"/notifications/:id",MARK_READ:"/notifications/:id/read",MARK_ALL_READ:"/notifications/read-all",DELETE:"/notifications/:id"},ADMIN:{USERS:"/admin/users",REPORTS:"/admin/reports",SETTINGS:"/admin/settings"}},r=(e,t={})=>{let s=e;return Object.keys(t).forEach(e=>{s=s.replace(`:${e}`,t[e])}),s},i={GET:"GET",POST:"POST",PUT:"PUT",PATCH:"PATCH",DELETE:"DELETE"};const E=new class{constructor(e="http://localhost:3000/api"){this.baseURL=e,this.defaultHeaders={"Content-Type":"application/json",Accept:"application/json"}}getAuthToken(){return e.getToken()}buildURL(e){const t=e.startsWith("/")?e:`/${e}`;return`${this.baseURL}${t}`}buildHeaders(e={}){const t={...this.defaultHeaders,...e},s=this.getAuthToken();return s&&(t.Authorization=`Bearer ${s}`),t}handleError(t,s){if(console.error(`[API] Error on ${s}:`,t),!t.response)return{success:!1,error:"Network error. Please check your connection.",status:0};const{status:a,data:o}=t.response;return 401===a?(e.clearSession(),window.location.href="/login",{success:!1,error:"Session expired. Please login again.",status:401}):{success:!1,error:(null==o?void 0:o.message)||"An error occurred",status:a,data:o}}async request(e,t,s=null,a={}){const o=this.buildURL(t),n={method:e,headers:this.buildHeaders(a.headers),...a};s&&[i.POST,i.PUT,i.PATCH].includes(e)&&(n.body=JSON.stringify(s));try{console.log(`[API] ${e} ${t}`);const s=await fetch(o,n);let a;const r=s.headers.get("content-type");if(a=r&&r.includes("application/json")?await s.json():await s.text(),!s.ok)throw{response:{status:s.status,data:a}};return console.log(`[API] ${e} ${t} - Success`),{success:!0,data:a,status:s.status}}catch(r){return this.handleError(r,t)}}async get(e,t={}){return this.request(i.GET,e,null,t)}async post(e,t,s={}){return this.request(i.POST,e,t,s)}async put(e,t,s={}){return this.request(i.PUT,e,t,s)}async patch(e,t,s={}){return this.request(i.PATCH,e,t,s)}async delete(e,t={}){return this.request(i.DELETE,e,null,t)}async upload(e,t,s="file",a={}){const o=this.buildURL(e),n=this.getAuthToken(),r=new FormData;r.append(s,t),Object.keys(a).forEach(e=>{r.append(e,a[e])});const i={};n&&(i.Authorization=`Bearer ${n}`);try{console.log(`[API] Upload to ${e}`);const t=await fetch(o,{method:"POST",headers:i,body:r}),s=await t.json();if(!t.ok)throw{response:{status:t.status,data:s}};return console.log(`[API] Upload to ${e} - Success`),{success:!0,data:s,status:t.status}}catch(E){return this.handleError(E,e)}}async download(e,t){const s=this.buildURL(e),a=this.getAuthToken(),o={};a&&(o.Authorization=`Bearer ${a}`);try{console.log(`[API] Download from ${e}`);const a=await fetch(s,{headers:o});if(!a.ok)throw new Error("Download failed");const n=await a.blob(),r=window.URL.createObjectURL(n),i=document.createElement("a");return i.href=r,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r),console.log(`[API] Download from ${e} - Success`),{success:!0,message:"File downloaded successfully"}}catch(n){return console.error("[API] Download failed:",n),{success:!1,error:"Failed to download file"}}}};export{n as A,E as a,r as b};
