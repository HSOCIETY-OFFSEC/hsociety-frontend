import{u as e,j as s}from"./index-Dj-t-wD2.js";import{r as a}from"./react-vendor-Dt--M4EP.js";import{N as t}from"./Navbar-DxjRtyBU.js";import{C as r,B as i}from"./Card-B9fCiNLr.js";import{v as l}from"./input.validator-7PKJK-co.js";import"./ThemeToggle-CQ0JBxkd.js";const n=()=>{const{user:n}=e(),[c,d]=a.useState("request"),[o,m]=a.useState(!1),[p,u]=a.useState([]),[h,g]=a.useState({targetType:"web-application",targetUrl:"",targetDescription:"",scope:"",preferredDate:"",urgency:"normal",additionalNotes:""}),[x,j]=a.useState({}),[v,N]=a.useState(!1);a.useEffect(()=>{"request"!==c&&f()},[c]);const f=async()=>{m(!0);try{await new Promise(e=>setTimeout(e,1e3));const e=[{id:"1",type:"Web Application",target:"https://example.com",status:"in-progress",startDate:Date.now()-432e6,estimatedCompletion:Date.now()+864e6,tester:"Security Team A"},{id:"2",type:"Network Infrastructure",target:"192.168.1.0/24",status:"completed",startDate:Date.now()-2592e6,completedDate:Date.now()-1296e6,tester:"Security Team B",reportAvailable:!0},{id:"3",type:"Mobile Application",target:"Android App v2.1",status:"scheduled",scheduledDate:Date.now()+6048e5,tester:"Security Team C"}];u(e)}catch(e){console.error("Failed to load engagements:",e)}finally{m(!1)}},y=e=>{const{name:s,value:a}=e.target;g(e=>({...e,[s]:a})),x[s]&&j(e=>({...e,[s]:""}))},b=async e=>{e.preventDefault(),j({}),N(!1);const s=l(h,{targetUrl:{required:!0,type:"url"},targetDescription:{required:!0,minLength:20},scope:{required:!0,minLength:10},preferredDate:{required:!0}});if(s.isValid){m(!0);try{await new Promise(e=>setTimeout(e,1500)),console.log("Pentest request submitted:",s.sanitizedData),N(!0),g({targetType:"web-application",targetUrl:"",targetDescription:"",scope:"",preferredDate:"",urgency:"normal",additionalNotes:""}),setTimeout(()=>{d("active")},2e3)}catch(a){j({submit:"Failed to submit request. Please try again."}),console.error("Pentest request failed:",a)}finally{m(!1)}}else j(s.errors)},D=e=>{switch(e){case"scheduled":return"#3b82f6";case"in-progress":return"#f59e0b";case"completed":return"#10b981";case"cancelled":return"#ef4444";default:return"#6b7280"}},w=e=>{switch(e){case"scheduled":return"Scheduled";case"in-progress":return"In Progress";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return"Unknown"}},q=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),S=e=>{const a="active"===e?p.filter(e=>["scheduled","in-progress"].includes(e.status)):p.filter(e=>["completed","cancelled"].includes(e.status));return o?s.jsxs("div",{className:"loading-state",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Loading engagements..."})]}):0===a.length?s.jsx(r,{padding:"large",children:s.jsxs("div",{className:"empty-state",children:[s.jsx("span",{style:{fontSize:"3rem"},children:"ðŸ“‹"}),s.jsxs("h3",{children:["No ",e," engagements"]}),s.jsx("p",{children:"active"===e?"You have no active or scheduled penetration tests.":"You have no completed penetration tests."}),"active"===e&&s.jsx(i,{variant:"primary",onClick:()=>d("request"),style:{marginTop:"1rem"},children:"Request New Pentest"})]})}):s.jsx("div",{className:"engagements-grid",children:a.map(e=>s.jsx(r,{hover3d:!0,padding:"large",shadow:"medium",children:s.jsxs("div",{className:"engagement-card",children:[s.jsxs("div",{className:"engagement-header",children:[s.jsx("h3",{className:"engagement-title",children:e.type}),s.jsx("span",{className:"status-badge",style:{background:`${D(e.status)}20`,color:D(e.status),border:`1px solid ${D(e.status)}50`},children:w(e.status)})]}),s.jsxs("div",{className:"engagement-details",children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Target:"}),s.jsx("span",{className:"detail-value",children:e.target})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Tester:"}),s.jsx("span",{className:"detail-value",children:e.tester})]}),"scheduled"===e.status&&s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Scheduled:"}),s.jsx("span",{className:"detail-value",children:q(e.scheduledDate)})]}),"in-progress"===e.status&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Started:"}),s.jsx("span",{className:"detail-value",children:q(e.startDate)})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Est. Completion:"}),s.jsx("span",{className:"detail-value",children:q(e.estimatedCompletion)})]})]}),"completed"===e.status&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Completed:"}),s.jsx("span",{className:"detail-value",children:q(e.completedDate)})]}),e.reportAvailable&&s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:"Report:"}),s.jsx("span",{className:"detail-value",children:s.jsx(i,{variant:"ghost",size:"small",children:"Download Report â†’"})})]})]})]}),s.jsx("div",{className:"engagement-actions",children:s.jsx(i,{variant:"secondary",size:"small",fullWidth:!0,children:"View Details"})})]})},e.id))})};return s.jsxs(s.Fragment,{children:[s.jsx(t,{}),s.jsx("div",{className:"pentest-container",children:s.jsxs("div",{className:"pentest-wrapper",children:[s.jsx("div",{className:"page-header",children:s.jsxs("div",{children:[s.jsx("h1",{className:"page-title",children:"Penetration Testing"}),s.jsx("p",{className:"page-subtitle",children:"Request and manage security penetration testing engagements"})]})}),s.jsxs("div",{className:"tabs-container",children:[s.jsx("button",{className:"tab "+("request"===c?"active":""),onClick:()=>d("request"),children:"ðŸ“ Request New Test"}),s.jsx("button",{className:"tab "+("active"===c?"active":""),onClick:()=>d("active"),children:"ðŸ”„ Active Engagements"}),s.jsx("button",{className:"tab "+("history"===c?"active":""),onClick:()=>d("history"),children:"ðŸ“š History"})]}),s.jsxs("div",{className:"tab-content",children:["request"===c&&s.jsxs(r,{padding:"large",shadow:"medium",children:[s.jsx("h2",{className:"section-title",children:"Request Penetration Test"}),s.jsx("p",{className:"section-subtitle",children:"Submit a request for our security team to conduct a comprehensive penetration test"}),v&&s.jsxs("div",{className:"success-message",children:[s.jsx("span",{className:"success-icon",children:"âœ“"}),s.jsxs("div",{children:[s.jsx("strong",{children:"Request submitted successfully!"}),s.jsx("p",{children:"Our team will review your request and contact you within 24-48 hours."})]})]}),x.submit&&s.jsxs("div",{className:"error-message",children:[s.jsx("span",{className:"error-icon",children:"âš "}),x.submit]}),s.jsxs("form",{onSubmit:b,className:"pentest-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"targetType",children:"Target Type *"}),s.jsxs("select",{id:"targetType",name:"targetType",value:h.targetType,onChange:y,className:"form-input",required:!0,children:[s.jsx("option",{value:"web-application",children:"Web Application"}),s.jsx("option",{value:"mobile-application",children:"Mobile Application"}),s.jsx("option",{value:"api",children:"API"}),s.jsx("option",{value:"network",children:"Network Infrastructure"}),s.jsx("option",{value:"physical",children:"Physical Security"}),s.jsx("option",{value:"social-engineering",children:"Social Engineering"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"targetUrl",children:"Target URL/Identifier *"}),s.jsx("input",{type:"text",id:"targetUrl",name:"targetUrl",value:h.targetUrl,onChange:y,placeholder:"https://example.com or 192.168.1.0/24",className:"form-input "+(x.targetUrl?"error":""),required:!0}),x.targetUrl&&s.jsx("span",{className:"field-error",children:x.targetUrl})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"targetDescription",children:"Target Description *"}),s.jsx("textarea",{id:"targetDescription",name:"targetDescription",value:h.targetDescription,onChange:y,placeholder:"Describe the target system, its purpose, and key features...",rows:4,className:"form-input "+(x.targetDescription?"error":""),required:!0}),x.targetDescription&&s.jsx("span",{className:"field-error",children:x.targetDescription}),s.jsx("span",{className:"field-hint",children:"Minimum 20 characters"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"scope",children:"Testing Scope *"}),s.jsx("textarea",{id:"scope",name:"scope",value:h.scope,onChange:y,placeholder:"Define what should and should not be tested. Include specific URLs, IP ranges, or features...",rows:4,className:"form-input "+(x.scope?"error":""),required:!0}),x.scope&&s.jsx("span",{className:"field-error",children:x.scope}),s.jsx("span",{className:"field-hint",children:"Be specific about in-scope and out-of-scope items"})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"preferredDate",children:"Preferred Start Date *"}),s.jsx("input",{type:"date",id:"preferredDate",name:"preferredDate",value:h.preferredDate,onChange:y,min:(new Date).toISOString().split("T")[0],className:"form-input "+(x.preferredDate?"error":""),required:!0}),x.preferredDate&&s.jsx("span",{className:"field-error",children:x.preferredDate})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"urgency",children:"Urgency Level"}),s.jsxs("select",{id:"urgency",name:"urgency",value:h.urgency,onChange:y,className:"form-input",children:[s.jsx("option",{value:"low",children:"Low - Routine Assessment"}),s.jsx("option",{value:"normal",children:"Normal - Standard Timeline"}),s.jsx("option",{value:"high",children:"High - Priority Engagement"}),s.jsx("option",{value:"critical",children:"Critical - Urgent Security Concern"})]})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"additionalNotes",children:"Additional Notes (Optional)"}),s.jsx("textarea",{id:"additionalNotes",name:"additionalNotes",value:h.additionalNotes,onChange:y,placeholder:"Any additional information, special requirements, or constraints...",rows:3,className:"form-input"})]}),s.jsx("div",{className:"form-actions",children:s.jsx(i,{type:"submit",variant:"primary",size:"large",loading:o,disabled:o,children:o?"Submitting...":"Submit Request"})})]})]}),"active"===c&&S("active"),"history"===c&&S("history")]})]})})]})};export{n as default};
