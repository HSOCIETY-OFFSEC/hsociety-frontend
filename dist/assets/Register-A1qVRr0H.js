import{s as e,j as s,L as a}from"./index-C0hON5x1.js";import{u as t,r}from"./react-vendor-Dt--M4EP.js";import{N as o,C as n,F as c,B as i,a as l}from"./Card-BLTIzP3v.js";import"./env.config-sfTiOdmx.js";/* empty css             */import"./icons-9q4Ww-N4.js";const d={LOGIN:"/auth/login",REGISTER:"/auth/register",LOGOUT:"/auth/logout",REFRESH:"/auth/refresh",VERIFY:"/auth/verify",ME:"/auth/me",PASSWORD_RESET_REQUEST:"/auth/password-reset/request",PASSWORD_RESET_CONFIRM:"/auth/password-reset/confirm",CHANGE_PASSWORD:"/auth/change-password"},u={GET:"GET",POST:"POST",PUT:"PUT",PATCH:"PATCH",DELETE:"DELETE"};const h=new class{constructor(e="http://localhost:3000/api"){this.baseURL=e,this.defaultHeaders={"Content-Type":"application/json",Accept:"application/json"}}getAuthToken(){return e.getToken()}buildURL(e){const s=e.startsWith("/")?e:`/${e}`;return`${this.baseURL}${s}`}buildHeaders(e={}){const s={...this.defaultHeaders,...e},a=this.getAuthToken();return a&&(s.Authorization=`Bearer ${a}`),s}handleError(s,a){if(console.error(`[API] Error on ${a}:`,s),!s.response)return{success:!1,error:"Network error. Please check your connection.",status:0};const{status:t,data:r}=s.response;return 401===t?(e.clearSession(),window.location.href="/login",{success:!1,error:"Session expired. Please login again.",status:401}):{success:!1,error:(null==r?void 0:r.message)||"An error occurred",status:t,data:r}}async request(e,s,a=null,t={}){const r=this.buildURL(s),o={method:e,headers:this.buildHeaders(t.headers),...t};a&&[u.POST,u.PUT,u.PATCH].includes(e)&&(o.body=JSON.stringify(a));try{console.log(`[API] ${e} ${s}`);const a=await fetch(r,o);let t;const n=a.headers.get("content-type");if(t=n&&n.includes("application/json")?await a.json():await a.text(),!a.ok)throw{response:{status:a.status,data:t}};return console.log(`[API] ${e} ${s} - Success`),{success:!0,data:t,status:a.status}}catch(n){return this.handleError(n,s)}}async get(e,s={}){return this.request(u.GET,e,null,s)}async post(e,s,a={}){return this.request(u.POST,e,s,a)}async put(e,s,a={}){return this.request(u.PUT,e,s,a)}async patch(e,s,a={}){return this.request(u.PATCH,e,s,a)}async delete(e,s={}){return this.request(u.DELETE,e,null,s)}async upload(e,s,a="file",t={}){const r=this.buildURL(e),o=this.getAuthToken(),n=new FormData;n.append(a,s),Object.keys(t).forEach(e=>{n.append(e,t[e])});const c={};o&&(c.Authorization=`Bearer ${o}`);try{console.log(`[API] Upload to ${e}`);const s=await fetch(r,{method:"POST",headers:c,body:n}),a=await s.json();if(!s.ok)throw{response:{status:s.status,data:a}};return console.log(`[API] Upload to ${e} - Success`),{success:!0,data:a,status:s.status}}catch(i){return this.handleError(i,e)}}async download(e,s){const a=this.buildURL(e),t=this.getAuthToken(),r={};t&&(r.Authorization=`Bearer ${t}`);try{console.log(`[API] Download from ${e}`);const t=await fetch(a,{headers:r});if(!t.ok)throw new Error("Download failed");const o=await t.blob(),n=window.URL.createObjectURL(o),c=document.createElement("a");return c.href=n,c.download=s,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(n),console.log(`[API] Download from ${e} - Success`),{success:!0,message:"File downloaded successfully"}}catch(o){return console.error("[API] Download failed:",o),{success:!1,error:"Failed to download file"}}}},m=()=>{const e=t(),[u,m]=r.useState(!1),[p,g]=r.useState(""),[y,f]=r.useState({accountType:"corporate",name:"",email:"",companyOrSchool:"",password:"",confirmPassword:"",agree:!1}),w=(e,s)=>{f(a=>({...a,[e]:s}))};return s.jsxs(s.Fragment,{children:[s.jsx(o,{}),s.jsx("div",{className:"auth-container",children:s.jsxs("div",{className:"auth-wrapper",children:[s.jsx("div",{className:"auth-logo",children:s.jsx(a,{size:"large"})}),s.jsxs(n,{className:"auth-card",children:[s.jsxs("div",{className:"auth-header",children:[s.jsx("h1",{children:"Create Account"}),s.jsx("p",{className:"auth-subtitle",children:"Register as a corporate team or student and get started."})]}),p&&s.jsxs("div",{className:"auth-error",children:[s.jsx("span",{className:"error-icon",children:s.jsx(c,{size:16})}),p]}),s.jsxs("form",{onSubmit:async s=>{s.preventDefault(),g("");const a=(e=>!e.name||e.name.trim().length<2?"Please enter your full name":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email||"")?!e.companyOrSchool||e.companyOrSchool.trim().length<2?"student"===e.accountType?"Please enter your school":"Please enter your company":!e.password||e.password.length<8?"Password must be at least 8 characters":e.password!==e.confirmPassword?"Passwords do not match":e.agree?"":"You must accept the terms to continue":"Please enter a valid email address")(y);if(a)g(a);else{m(!0);try{const s=(e=>({role:"student"===e.accountType?"student":"corporate",profile:{fullName:e.name.trim(),organization:e.companyOrSchool.trim()},credentials:{email:e.email.trim().toLowerCase(),password:e.password},consent:{acceptedTerms:Boolean(e.agree),acceptedAt:(new Date).toISOString()},metadata:{source:"web",version:"1"}}))(y),a=await(async e=>{try{const s=await h.post(d.REGISTER,e);return s.success?{success:!0,data:s.data}:{success:!1,error:s.error||"Registration request failed"}}catch(p){return console.error("[REGISTER] Failed:",p),{success:!1,error:p.message||"Registration request failed"}}})(s);if(!a.success)throw new Error(a.error||"Registration failed");e("/login",{state:{email:s.credentials.email}})}catch(t){console.error("Registration failed:",t),g("Registration failed. Please try again.")}finally{m(!1)}}},className:"auth-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Account Type"}),s.jsxs("div",{className:"auth-toggle",children:[s.jsx("button",{type:"button",className:"corporate"===y.accountType?"active":"",onClick:()=>w("accountType","corporate"),disabled:u,children:"Corporate"}),s.jsx("button",{type:"button",className:"student"===y.accountType?"active":"",onClick:()=>w("accountType","student"),disabled:u,children:"Student"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"register-name",children:"Full Name"}),s.jsx("input",{id:"register-name",type:"text",className:"form-input",value:y.name,onChange:e=>w("name",e.target.value),placeholder:"Jane Doe",disabled:u})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"register-email",children:"Email Address"}),s.jsx("input",{id:"register-email",type:"email",className:"form-input",value:y.email,onChange:e=>w("email",e.target.value),placeholder:"you@example.com",disabled:u})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"register-org",children:"student"===y.accountType?"School / Program":"Company"}),s.jsx("input",{id:"register-org",type:"text",className:"form-input",value:y.companyOrSchool,onChange:e=>w("companyOrSchool",e.target.value),placeholder:"student"===y.accountType?"University name":"Company name",disabled:u})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"register-password",children:"Password"}),s.jsx("input",{id:"register-password",type:"password",className:"form-input",value:y.password,onChange:e=>w("password",e.target.value),placeholder:"At least 8 characters",disabled:u})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"register-confirm-password",children:"Confirm Password"}),s.jsx("input",{id:"register-confirm-password",type:"password",className:"form-input",value:y.confirmPassword,onChange:e=>w("confirmPassword",e.target.value),placeholder:"Re-enter password",disabled:u})]}),s.jsxs("label",{className:"auth-checkbox",children:[s.jsx("input",{type:"checkbox",checked:y.agree,onChange:e=>w("agree",e.target.checked),disabled:u}),s.jsx("span",{children:"I agree to the Terms and Privacy Policy"})]}),s.jsx(i,{type:"submit",variant:"primary",fullWidth:!0,loading:u,disabled:u,children:u?"Creating account...":"Create Account"})]}),s.jsx("div",{className:"auth-footer",children:s.jsxs("p",{children:["Already have an account?"," ",s.jsx("button",{onClick:()=>e("/login"),className:"auth-link-inline",disabled:u,children:"Login"})]})})]}),s.jsx("div",{className:"auth-notice",children:s.jsxs("p",{children:[s.jsx("span",{className:"notice-icon",children:s.jsx(l,{size:16})}),"Your registration data is encrypted in transit."]})})]})})]})};export{m as default};
