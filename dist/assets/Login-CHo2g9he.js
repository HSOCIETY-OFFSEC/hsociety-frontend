import{u as e,j as a,L as s}from"./index-BKTFHamk.js";import{u as t,d as r,r as i}from"./react-vendor-Dt--M4EP.js";import{N as l,C as o,F as n,a as c}from"./Card-D7Goz3Sa.js";import{B as d}from"./Button-Byl8E1dD.js";/* empty css             */import"./icons-9q4Ww-N4.js";const u=()=>{var u;const m=t(),h=r(),{login:p}=e(),[j,x]=i.useState(1),[f,g]=i.useState((null==(u=h.state)?void 0:u.email)||""),[y,v]=i.useState("corporate"),[b,N]=i.useState(""),[P,T]=i.useState(""),[w,F]=i.useState(!1),[S,C]=i.useState(""),O=async()=>{try{const e={id:"1",email:f,name:"Test User",role:y},a="mock-jwt-token-"+Date.now();await p(e,a),m("student"===y?"/student-dashboard":"/dashboard")}catch(e){C("Login failed. Please try again."),console.error("Login error:",e)}},k=()=>{x(1),g(""),N(""),T(""),C(""),v("corporate")};return a.jsxs(a.Fragment,{children:[a.jsx(l,{}),a.jsx("div",{className:"auth-container",children:a.jsxs("div",{className:"auth-wrapper",children:[a.jsx("div",{className:"auth-logo",children:a.jsx(s,{size:"large"})}),a.jsxs(o,{className:"auth-card",children:[a.jsxs("div",{className:"auth-header",children:[a.jsx("h1",{children:"Secure Login"}),a.jsxs("p",{className:"auth-subtitle",children:[1===j&&"Enter your email to receive a one-time password",2===j&&"Enter the OTP sent to your email",3===j&&"Enter your 2FA authentication code"]})]}),S&&a.jsxs("div",{className:"auth-error",children:[a.jsx("span",{className:"error-icon",children:a.jsx(n,{size:16})}),S]}),1===j&&a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),C("");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f)){F(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("OTP requested for:",f),x(2)}catch(a){C("Failed to send OTP. Please try again."),console.error("OTP request error:",a)}finally{F(!1)}}else C("Please enter a valid email address")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Account Type"}),a.jsxs("div",{className:"auth-toggle",children:[a.jsx("button",{type:"button",className:"corporate"===y?"active":"",onClick:()=>v("corporate"),disabled:w,children:"Corporate"}),a.jsx("button",{type:"button",className:"student"===y?"active":"",onClick:()=>v("student"),disabled:w,children:"Student"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email Address"}),a.jsx("input",{type:"email",id:"email",value:f,onChange:e=>g(e.target.value),placeholder:"you@example.com",required:!0,autoFocus:!0,disabled:w,className:"form-input"})]}),a.jsx(d,{type:"submit",variant:"primary",fullWidth:!0,loading:w,disabled:w,children:w?"Sending OTP...":"Request OTP"})]}),2===j&&a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),C(""),6===b.length){F(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("OTP verified:",b);!0&&x(3)}catch(a){C("Invalid OTP. Please try again."),console.error("OTP verification error:",a)}finally{F(!1)}}else C("OTP must be 6 digits")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"otp",children:"One-Time Password"}),a.jsx("input",{type:"text",id:"otp",value:b,onChange:e=>N(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,required:!0,autoFocus:!0,disabled:w,className:"form-input otp-input"}),a.jsx("span",{className:"form-hint",children:"Check your email for the 6-digit code"})]}),a.jsx(d,{type:"submit",variant:"primary",fullWidth:!0,loading:w,disabled:w||6!==b.length,children:w?"Verifying...":"Verify OTP"}),a.jsx("button",{type:"button",onClick:k,className:"auth-link",disabled:w,children:"Use a different email"})]}),3===j&&a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),C(""),6===P.length){F(!0);try{await new Promise(e=>setTimeout(e,1e3)),console.log("2FA verified:",P),await O()}catch(a){C("Invalid 2FA code. Please try again."),console.error("2FA verification error:",a)}finally{F(!1)}}else C("2FA code must be 6 digits")},className:"auth-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"twofa",children:"Two-Factor Authentication"}),a.jsx("input",{type:"text",id:"twofa",value:P,onChange:e=>T(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,required:!0,autoFocus:!0,disabled:w,className:"form-input otp-input"}),a.jsx("span",{className:"form-hint",children:"Enter code from your authenticator app"})]}),a.jsx(d,{type:"submit",variant:"primary",fullWidth:!0,loading:w,disabled:w||6!==P.length,children:w?"Verifying...":"Verify 2FA"}),a.jsx("button",{type:"button",onClick:k,className:"auth-link",disabled:w,children:"Start over"})]}),a.jsx("div",{className:"auth-footer",children:a.jsxs("p",{children:["Don't have an account?"," ",a.jsx("button",{onClick:()=>m("/register"),className:"auth-link-inline",disabled:w,children:"Register here"})]})})]}),a.jsx("div",{className:"auth-notice",children:a.jsxs("p",{children:[a.jsx("span",{className:"notice-icon",children:a.jsx(c,{size:16})}),"Your security is our priority. All communications are encrypted."]})})]})})]})};export{u as default};
