const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-DKBJGcpE.js","assets/react-vendor-Dt--M4EP.js","assets/Card-BuSz5BGb.js","assets/icons-9q4Ww-N4.js","assets/Login-Be76OOWd.css","assets/Dashboard-BetnRlxz.js","assets/ThemeToggle-J-qBBjf6.js","assets/Navbar-BVJCGEJf.js","assets/Skeleton-DsKHMcMe.js","assets/Dashboard-yJGRcZoo.css","assets/Audits-ldbx-XXj.js","assets/Audits-Bu2iMoAC.css","assets/Pentest-DnI8ujeo.js","assets/input.validator-7PKJK-co.js","assets/Pentest-sgSR7sqF.css","assets/Feedback-C7X-4UCP.js","assets/Feedback-BwnHc5UG.css","assets/Landing-BYBluVhB.js","assets/Landing-7-5JWl0N.css"])))=>i.map(i=>d[i]);
import{r as e,a as t,R as o,B as r,b as s,c as n,N as i}from"./react-vendor-Dt--M4EP.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var a={exports:{}},l={},c=e,u=Symbol.for("react.element"),d=Symbol.for("react.fragment"),h=Object.prototype.hasOwnProperty,m=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,g={key:!0,ref:!0,__self:!0,__source:!0};function p(e,t,o){var r,s={},n=null,i=null;for(r in void 0!==o&&(n=""+o),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(i=t.ref),t)h.call(t,r)&&!g.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:u,type:e,key:n,ref:i,props:s,_owner:m.current}}l.Fragment=d,l.jsx=p,l.jsxs=p,a.exports=l;var f=a.exports,y={},x=t;y.createRoot=x.createRoot,y.hydrateRoot=x.hydrateRoot;const w="hsociety_session";const j=new class{constructor(){this.storage="undefined"!=typeof window?window.sessionStorage:null}setSession(e){if(!this.storage)return!1;try{const t={...e,timestamp:e.timestamp||Date.now(),expiresAt:Date.now()+864e5};return this.storage.setItem(w,JSON.stringify(t)),!0}catch(t){return console.error("Failed to set session:",t),!1}}getSession(){if(!this.storage)return null;try{const e=this.storage.getItem(w);return e?JSON.parse(e):null}catch(e){return console.error("Failed to get session:",e),null}}updateSession(e){const t=this.getSession();if(!t)return!1;const o={...t,...e,timestamp:Date.now()};return this.setSession(o)}clearSession(){if(this.storage)try{this.storage.removeItem(w),this.storage.removeItem("logout-reason")}catch(e){console.error("Failed to clear session:",e)}}isSessionValid(){const e=this.getSession();return!!e&&(!(!e.user||!e.token)&&(!(e.expiresAt&&Date.now()>e.expiresAt)||(console.log("Session expired"),this.clearSession(),!1)))}getToken(){const e=this.getSession();return e?e.token:null}getUser(){const e=this.getSession();return e?e.user:null}isAuthenticated(){return this.isSessionValid()}getSessionAge(){const e=this.getSession();return e&&e.timestamp?Date.now()-e.timestamp:null}getTimeUntilExpiry(){const e=this.getSession();if(!e||!e.expiresAt)return null;const t=e.expiresAt-Date.now();return t>0?t:0}},S=e.createContext(void 0),_=({children:t})=>{const[o,r]=e.useState(null),[s,n]=e.useState(null),[i,a]=e.useState(!1),[l,c]=e.useState(!0),[u,d]=e.useState(null);e.useEffect(()=>{h()},[]);const h=async()=>{try{c(!0);const e=j.getSession();if(e&&e.token&&e.user){j.isSessionValid()?(r(e.user),n(e.token),a(!0),m()):await g(!1)}}catch(e){console.error("Auth initialization error:",e),await g(!1)}finally{c(!1)}},m=()=>{u&&u();const e=(({timeout:e=9e5,onTimeout:t,onWarning:o=null,warningTime:r=12e4,events:s=["mousedown","keydown","scroll","touchstart","click","mousemove"]}={})=>{if(!t||"function"!=typeof t)return console.error("Auto logout requires onTimeout callback"),()=>{};let n=null,i=null,a=!1;const l=()=>{a=!1,n&&clearTimeout(n),i&&clearTimeout(i),o&&r>0&&r<e&&(i=setTimeout(()=>{a||(a=!0,o({remainingTime:e-r,totalTimeout:e}))},e-r)),n=setTimeout(()=>{console.log("Auto logout triggered due to inactivity"),t()},e)},c=()=>{l()};return s.forEach(e=>{window.addEventListener(e,c,{passive:!0})}),l(),()=>{s.forEach(e=>{window.removeEventListener(e,c)}),n&&clearTimeout(n),i&&clearTimeout(i),console.log("Auto logout monitor cleaned up")}})({timeout:9e5,onTimeout:async()=>{console.log("Session timed out due to inactivity"),await g(!0)},events:["mousedown","keydown","scroll","touchstart","click"]});d(()=>e)},g=async(e=!1)=>{try{u&&(u(),d(null)),j.clearSession(),r(null),n(null),a(!1),e&&sessionStorage.setItem("logout-reason","inactivity"),"undefined"!=typeof window&&(window.location.href="/login")}catch(t){console.error("Logout error:",t),j.clearSession(),r(null),n(null),a(!1)}},p={user:o,token:s,isAuthenticated:i,isLoading:l,login:async(e,t)=>{try{if(!e||!t)throw new Error("Invalid login credentials");return j.setSession({user:e,token:t,timestamp:Date.now()}),r(e),n(t),a(!0),m(),{success:!0}}catch(o){return console.error("Login error:",o),{success:!1,error:o.message}}},logout:g,updateUser:e=>{if(!i)return;const t={...o,...e};j.updateSession({user:t}),r(t)},refreshToken:async()=>{try{const e=s;return j.updateSession({token:e}),n(e),{success:!0,token:e}}catch(e){return console.error("Token refresh error:",e),await g(),{success:!1,error:e.message}}},hasRole:e=>!(!o||!o.role)&&o.role===e,hasAnyRole:e=>!(!o||!o.role)&&e.includes(o.role)};return f.jsx(S.Provider,{value:p,children:t})},v=()=>{const t=e.useContext(S);if(void 0===t)throw new Error("useAuth must be used within an AuthProvider");return t},E=e.createContext(void 0),k=({children:t})=>{const[o,r]=e.useState(()=>{if("undefined"!=typeof window){return localStorage.getItem("hsociety-theme")||"light"}return"light"});e.useEffect(()=>{const e=document.documentElement;e.removeAttribute("data-theme"),e.setAttribute("data-theme",o),localStorage.setItem("hsociety-theme",o);const t=document.querySelector('meta[name="theme-color"]');t&&t.setAttribute("content","dark"===o?"#000000":"#ffffff"),s(o)},[o]);const s=e=>{const t=document.querySelector('link[rel="icon"]'),o=document.querySelector('link[rel="apple-touch-icon"]'),r="dark"===e?"/FAVICON_HSOCIETY_WHITE/favicon.ico":"/FAVICON_HSOCIETY_BLACK/favicon.ico",s="dark"===e?"/FAVICON_HSOCIETY_WHITE/apple-touch-icon.png":"/FAVICON_HSOCIETY_BLACK/apple-touch-icon.png";t&&(t.href=r),o&&(o.href=s)},n={theme:o,toggleTheme:()=>{r(e=>"light"===e?"dark":"light")},setTheme:e=>{"light"!==e&&"dark"!==e||r(e)},isDark:"dark"===o,isLight:"light"===o};return f.jsx(E.Provider,{value:n,children:t})},A=()=>{const t=e.useContext(E);if(void 0===t)throw new Error("useTheme must be used within a ThemeProvider");return t},T={},I=function(e,t,o){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),o=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in T)return;T[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script"),s.crossOrigin="",s.href=e,o&&s.setAttribute("nonce",o),document.head.appendChild(s),t?new Promise((t,o)=>{s.addEventListener("load",t),s.addEventListener("error",()=>o(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})},L=({size:e="medium",clickable:t=!1,className:o="",onClick:r=null})=>{const{theme:s}=A(),n="dark"===s?"/hsociety-logo-white.png":"/hsociety-logo-black.png",i={...{small:{height:"32px",width:"auto"},medium:{height:"48px",width:"auto"},large:{height:"64px",width:"auto"},xlarge:{height:"96px",width:"auto"}}[e],display:"block",objectFit:"contain",transition:"all 0.3s ease",cursor:t||r?"pointer":"default"};return f.jsx("div",{className:`logo-container ${o}`,onClick:()=>{r?r():t&&(window.location.href="/")},style:{display:"inline-flex",alignItems:"center",justifyContent:"center"},children:f.jsx("img",{src:n,alt:"HSOCIETY Logo",style:i,className:"logo-image",onError:e=>{console.error("Logo failed to load:",n),e.target.style.display="none"}})})},O=({message:e="Initializing secure workspace..."})=>f.jsx("div",{className:"page-loader",role:"status","aria-live":"polite",children:f.jsxs("div",{className:"page-loader-inner",children:[f.jsx(L,{size:"large",className:"page-loader-logo"}),f.jsx("div",{className:"page-loader-bar"}),f.jsx("p",{className:"page-loader-text",children:e})]})}),b=o.lazy(()=>I(()=>import("./Login-DKBJGcpE.js"),__vite__mapDeps([0,1,2,3,4]))),P=o.lazy(()=>I(()=>import("./Dashboard-BetnRlxz.js"),__vite__mapDeps([5,1,2,3,6,7,8,9]))),C=o.lazy(()=>I(()=>import("./Audits-ldbx-XXj.js"),__vite__mapDeps([10,1,2,3,7,6,8,11]))),N=o.lazy(()=>I(()=>import("./Pentest-DnI8ujeo.js"),__vite__mapDeps([12,1,2,3,7,6,8,13,14]))),R=o.lazy(()=>I(()=>import("./Feedback-C7X-4UCP.js"),__vite__mapDeps([15,1,2,3,7,6,13,16]))),D=o.lazy(()=>I(()=>import("./Landing-BYBluVhB.js"),__vite__mapDeps([17,1,6,2,3,18]))),V=({children:e})=>{const{isAuthenticated:t,isLoading:o}=v();return o?f.jsx(O,{message:"Authenticating session..."}):t?e:f.jsx(i,{to:"/login",replace:!0})},F=({children:e})=>{const{isAuthenticated:t,isLoading:o}=v();return o?f.jsx(O,{message:"Preparing your workspace..."}):t?f.jsx(i,{to:"/dashboard",replace:!0}):e},z=()=>f.jsx(O,{message:"Loading secure interface..."}),q=()=>f.jsx(r,{children:f.jsx(o.Suspense,{fallback:f.jsx(z,{}),children:f.jsxs(s,{children:[f.jsx(n,{path:"/",element:f.jsx(D,{})}),f.jsx(n,{path:"/login",element:f.jsx(F,{children:f.jsx(b,{})})}),f.jsx(n,{path:"/feedback",element:f.jsx(R,{})}),f.jsx(n,{path:"/dashboard",element:f.jsx(V,{children:f.jsx(P,{})})}),f.jsx(n,{path:"/audits",element:f.jsx(V,{children:f.jsx(C,{})})}),f.jsx(n,{path:"/pentest",element:f.jsx(V,{children:f.jsx(N,{})})}),f.jsx(n,{path:"*",element:f.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[f.jsx("h1",{children:"404"}),f.jsx("p",{children:"Page not found"}),f.jsx("a",{href:"/",children:"Go home"})]})})]})})}),H=()=>f.jsx(k,{children:f.jsx(_,{children:f.jsx(q,{})})}),B=document.getElementById("root");if(!B)throw new Error('Failed to find the root element. Make sure index.html has a div with id="root"');y.createRoot(B).render(f.jsx(o.StrictMode,{children:f.jsx(H,{})}));export{L,A as a,f as j,v as u};
