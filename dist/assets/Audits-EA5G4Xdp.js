import{u as e,j as s}from"./index-BKTFHamk.js";import{r as a}from"./react-vendor-Dt--M4EP.js";import{N as i,C as l,e as t,c as r,f as d}from"./Card-D7Goz3Sa.js";import{B as n}from"./Button-Byl8E1dD.js";import{u as c}from"./useScrollReveal-BC-245pq.js";import{S as o}from"./Skeleton-dYOkrYE5.js";import{g as m}from"./helpers-CQG1Y5Ia.js";import{a as u,A as h,b as x}from"./api.client-DUIoE9I7.js";import"./icons-9q4Ww-N4.js";const j=(e={})=>{var s,a,i,l,t;return{id:String(e.id||""),title:e.title||"Untitled audit",type:e.type||"General",date:e.date||Date.now(),status:e.status||"draft",severity:{critical:Number((null==(s=null==e?void 0:e.severity)?void 0:s.critical)||0),high:Number((null==(a=null==e?void 0:e.severity)?void 0:a.high)||0),medium:Number((null==(i=null==e?void 0:e.severity)?void 0:i.medium)||0),low:Number((null==(l=null==e?void 0:e.severity)?void 0:l.low)||0),info:Number((null==(t=null==e?void 0:e.severity)?void 0:t.info)||0)},remediationProgress:Number(e.remediationProgress||0),tester:e.tester||"Security Team",reportAvailable:Boolean(e.reportAvailable)}},p=(e=[])=>e.map(j),v=()=>{const{user:j}=e(),[v,N]=a.useState(!0),[y,g]=a.useState([]),[f,b]=a.useState([]),[w,k]=a.useState(null),[S,A]=a.useState("all"),[C,T]=a.useState(""),[D,F]=a.useState("");c(".reveal-on-scroll",{},[v,f.length]),a.useEffect(()=>{R()},[]),a.useEffect(()=>{z()},[y,S,C]);const R=async()=>{N(!0),F("");try{const e=await(async()=>{var e;const s=await u.get(h.AUDITS.LIST);return s.success?{success:!0,data:p(Array.isArray(s.data)?s.data:(null==(e=s.data)?void 0:e.items)||[])}:{success:!1,error:s.error||"Failed to load audits"}})();if(!e.success)throw new Error(e.error||"Failed to load audits");g(e.data)}catch(e){console.error("Failed to load audits:",e),F("Failed to load audits.")}finally{N(!1)}},z=()=>{let e=[...y];if("all"!==S&&(e=e.filter(e=>e.status===S)),C.trim()){const s=C.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(s)||e.type.toLowerCase().includes(s)||e.tester.toLowerCase().includes(s))}b(e)},L=e=>{switch(e){case"critical":return"#dc2626";case"high":return"#f59e0b";case"medium":return"#eab308";case"low":return"#3b82f6";default:return"#6b7280"}},P=e=>{switch(e){case"completed":return"#10b981";case"in-review":return"#f59e0b";default:return"#6b7280"}},$=e=>{switch(e){case"completed":return"Completed";case"in-review":return"In Review";case"draft":return"Draft";default:return"Unknown"}},I=async e=>{const s=await(async e=>{const s=x(h.AUDITS.DOWNLOAD,{id:e}),a=`audit-report-${e}.pdf`;return await u.download(s,a)})(e);s.success||F(s.error||"Failed to download report.")},O=e=>{return s.jsx(l,{hover3d:!0,padding:"large",shadow:"medium",children:s.jsxs("div",{className:"audit-card",children:[s.jsxs("div",{className:"audit-header",children:[s.jsxs("div",{className:"audit-title-section",children:[s.jsx("h3",{className:"audit-title",children:e.title}),s.jsxs("div",{className:"audit-meta",children:[s.jsx("span",{className:"audit-type",children:e.type}),s.jsx("span",{className:"audit-date",children:m(e.date)})]})]}),s.jsx("span",{className:"status-badge",style:{background:`${P(e.status)}20`,color:P(e.status),border:`1px solid ${P(e.status)}50`},children:$(e.status)})]}),s.jsxs("div",{className:"severity-summary",children:[s.jsx("h4",{className:"summary-title",children:"Findings by Severity"}),s.jsx("div",{className:"severity-grid",children:Object.entries(e.severity).map(([e,a])=>s.jsx("div",{className:"severity-item",children:s.jsxs("div",{className:"severity-badge",style:{background:`${L(e)}20`,color:L(e),border:`1px solid ${L(e)}50`},children:[s.jsx("span",{className:"severity-count",children:a}),s.jsx("span",{className:"severity-label",children:e})]})},e))}),s.jsxs("div",{className:"total-findings",children:["Total: ",(a=e.severity,Object.values(a).reduce((e,s)=>e+s,0))," findings"]})]}),"completed"===e.status&&s.jsxs("div",{className:"remediation-section",children:[s.jsxs("div",{className:"remediation-header",children:[s.jsx("span",{className:"remediation-label",children:"Remediation Progress"}),s.jsxs("span",{className:"remediation-percentage",children:[e.remediationProgress,"%"]})]}),s.jsx("div",{className:"progress-bar",children:s.jsx("div",{className:"progress-fill",style:{width:`${e.remediationProgress}%`,background:100===e.remediationProgress?"#10b981":"#f59e0b"}})})]}),s.jsxs("div",{className:"audit-footer",children:[s.jsxs("div",{className:"audit-tester",children:[s.jsx("span",{className:"tester-label",children:"Assessed by:"}),s.jsx("span",{className:"tester-name",children:e.tester})]}),s.jsxs("div",{className:"audit-actions",children:[s.jsx(n,{variant:"secondary",size:"small",onClick:()=>(e=>{k(e)})(e),children:"View Details"}),e.reportAvailable&&s.jsxs(n,{variant:"primary",size:"small",onClick:()=>I(e.id),children:[s.jsx(d,{size:16}),"Download"]})]})]})]})},e.id);var a};return v?s.jsxs(s.Fragment,{children:[s.jsx(i,{}),s.jsx("div",{className:"audits-container",children:s.jsxs("div",{className:"audits-wrapper",children:[s.jsxs("div",{className:"page-header",children:[s.jsx(o,{className:"skeleton-line",style:{width:"220px"}}),s.jsx(o,{className:"skeleton-line",style:{width:"320px",marginTop:"0.75rem"}})]}),s.jsx(l,{padding:"medium",shadow:"small",children:s.jsxs("div",{className:"filters-section",children:[s.jsx("div",{className:"search-box",children:s.jsx(o,{className:"skeleton-rect",style:{width:"100%",height:"44px",borderRadius:"8px"}})}),s.jsxs("div",{className:"filter-group",children:[s.jsx(o,{className:"skeleton-line",style:{width:"70px"}}),s.jsx("div",{className:"filter-buttons",style:{gap:"0.5rem"},children:[...Array(3)].map((e,a)=>s.jsx(o,{className:"skeleton-rect",style:{width:"90px",height:"36px",borderRadius:"8px"}},a))})]})]})}),s.jsx("div",{className:"audits-grid",children:[...Array(3)].map((e,a)=>s.jsx(l,{padding:"large",shadow:"medium",children:s.jsxs("div",{className:"audit-card",children:[s.jsxs("div",{className:"audit-header",children:[s.jsx(o,{className:"skeleton-line",style:{width:"200px"}}),s.jsx(o,{className:"skeleton-line",style:{width:"80px",height:"20px"}})]}),s.jsxs("div",{className:"audit-meta",style:{marginTop:"1rem"},children:[s.jsx(o,{className:"skeleton-line",style:{width:"160px"}}),s.jsx(o,{className:"skeleton-line",style:{width:"120px"}})]}),s.jsxs("div",{className:"audit-summary",style:{marginTop:"1.5rem"},children:[s.jsx(o,{className:"skeleton-line",style:{width:"100%"}}),s.jsx(o,{className:"skeleton-line",style:{width:"80%",marginTop:"0.5rem"}})]}),s.jsxs("div",{className:"audit-footer",style:{marginTop:"1.5rem"},children:[s.jsx(o,{className:"skeleton-line",style:{width:"140px"}}),s.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[s.jsx(o,{className:"skeleton-rect",style:{width:"110px",height:"36px",borderRadius:"8px"}}),s.jsx(o,{className:"skeleton-rect",style:{width:"110px",height:"36px",borderRadius:"8px"}})]})]})]})},a))})]})})]}):s.jsxs(s.Fragment,{children:[s.jsx(i,{}),s.jsx("div",{className:"audits-container",children:s.jsxs("div",{className:"audits-wrapper",children:[s.jsx("div",{className:"page-header reveal-on-scroll",children:s.jsxs("div",{children:[s.jsx("h1",{className:"page-title",children:"Security Audits"}),s.jsx("p",{className:"page-subtitle",children:"View and manage security audit reports and vulnerability assessments"})]})}),s.jsx(l,{padding:"medium",shadow:"small",className:"reveal-on-scroll",children:s.jsxs("div",{className:"filters-section",children:[s.jsxs("div",{className:"search-box",children:[s.jsx("span",{className:"search-icon",children:s.jsx(t,{size:16})}),s.jsx("input",{type:"text",placeholder:"Search audits...",value:C,onChange:e=>T(e.target.value),className:"search-input"})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Status:"}),s.jsxs("div",{className:"filter-buttons",children:[s.jsx("button",{className:"filter-button "+("all"===S?"active":""),onClick:()=>A("all"),children:"All"}),s.jsx("button",{className:"filter-button "+("completed"===S?"active":""),onClick:()=>A("completed"),children:"Completed"}),s.jsx("button",{className:"filter-button "+("in-review"===S?"active":""),onClick:()=>A("in-review"),children:"In Review"})]})]})]})}),s.jsx("div",{className:"results-info reveal-on-scroll",children:s.jsxs("p",{children:["Showing ",s.jsx("strong",{children:f.length})," of ",s.jsx("strong",{children:y.length})," audits"]})}),D&&s.jsx(l,{padding:"medium",shadow:"small",className:"reveal-on-scroll",children:s.jsx("p",{style:{margin:0,color:"var(--text-secondary)"},children:D})}),0===f.length?s.jsx(l,{padding:"large",className:"reveal-on-scroll",children:s.jsxs("div",{className:"empty-state",children:[s.jsx("span",{style:{fontSize:"3rem",display:"inline-flex"},children:s.jsx(r,{size:40})}),s.jsx("h3",{children:"No audits found"}),s.jsx("p",{children:C?"Try adjusting your search query or filters.":"No security audits available at the moment."})]})}):s.jsx("div",{className:"audits-grid reveal-on-scroll",children:f.map(e=>O(e))})]})})]})};export{v as default};
