const e=(e,t={})=>{const r={},s={};let a=!0;return Object.keys(e).forEach(n=>{const i=e[n],o=t[n]||{};if(o.required&&(!i||""===i.trim()))return r[n]=`${n} is required`,void(a=!1);if(o.required||i&&""!==i.trim()){switch(o.type){case"email":(e=>{if(!e||"string"!=typeof e)return!1;const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),r=e.length>=5&&e.length<=254,s=/\.[a-z]{2,}$/i.test(e);return t&&r&&s})(i)||(r[n]="Invalid email format",a=!1);break;case"url":(e=>{if(!e||"string"!=typeof e)return!1;try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(t){return!1}})(i)||(r[n]="Invalid URL format",a=!1);break;case"phone":(e=>{if(!e||"string"!=typeof e)return!1;const t=e.replace(/[\s\-\(\)\.]/g,"");return/^\+?[1-9]\d{6,14}$/.test(t)})(i)||(r[n]="Invalid phone number",a=!1);break;case"password":const e=(e=>{const t=[];let r=0;return e&&"string"==typeof e?(e.length<8?t.push("Password must be at least 8 characters long"):r+=20,/[A-Z]/.test(e)?r+=20:t.push("Password must contain at least one uppercase letter"),/[a-z]/.test(e)?r+=20:t.push("Password must contain at least one lowercase letter"),/[0-9]/.test(e)?r+=20:t.push("Password must contain at least one number"),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)?r+=20:t.push("Password must contain at least one special character"),{isValid:0===t.length,errors:t,strength:r}):{isValid:!1,errors:["Password is required"],strength:0}})(i);e.isValid||(r[n]=e.errors.join(", "),a=!1)}o.minLength&&i.length<o.minLength&&(r[n]=`Minimum length is ${o.minLength}`,a=!1),o.maxLength&&i.length>o.maxLength&&(r[n]=`Maximum length is ${o.maxLength}`,a=!1),s[n]=(e=>{if(!e||"string"!=typeof e)return"";let t=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");return t=t.replace(/<[^>]+>/g,""),t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),t.trim()})(i)}else s[n]=""}),{isValid:a,sanitizedData:s,errors:r}};export{e as v};
