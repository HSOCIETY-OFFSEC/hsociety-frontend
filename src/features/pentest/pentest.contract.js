/**
 * Pentest contract
 * Location: src/features/pentest/pentest.contract.js
 */

export const buildPentestRequestDTO = (form) => ({
  target: {
    type: form.targetType,
    identifier: form.targetUrl.trim(),
    description: form.targetDescription.trim()
  },
  scope: form.scope.trim(),
  schedule: {
    preferredStartDate: form.preferredDate
  },
  priority: form.urgency,
  notes: form.additionalNotes?.trim() || '',
  metadata: {
    source: 'web',
    version: '1'
  }
});

export const normalizeEngagements = (engagements = []) =>
  engagements.map((engagement) => ({
    id: String(engagement.id || ''),
    type: engagement.type || 'Security Test',
    target: engagement.target || '',
    status: engagement.status || 'scheduled',
    startDate: engagement.startDate || null,
    estimatedCompletion: engagement.estimatedCompletion || null,
    completedDate: engagement.completedDate || null,
    scheduledDate: engagement.scheduledDate || null,
    tester: engagement.tester || 'Security Team',
    reportAvailable: Boolean(engagement.reportAvailable)
  }));

export default {
  buildPentestRequestDTO,
  normalizeEngagements
};
